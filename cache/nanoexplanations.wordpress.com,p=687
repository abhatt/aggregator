<?xml version="1.0" encoding="utf-8"?><entry xml:lang="en" xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>http://nanoexplanations.wordpress.com/?p=687</id><link href="https://nanoexplanations.wordpress.com/2012/01/27/watermarking-molecules/" rel="alternate" type="text/html"/><title>Watermarking molecules</title><summary type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml">I’ve posted twice about Anonymous hacking into Stratfor — and, more generally, their hacktivism has been making bigger and bigger waves.  CNN recently ran a fairly positive story on the support hacktivists are providing the Occupy movement.  Many of these … <a href="https://nanoexplanations.wordpress.com/2012/01/27/watermarking-molecules/">Continue reading <span class="meta-nav">→</span></a></div><div class="commentbar"><p/></div></summary><content type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><p><span style="float: left; padding: 5px;"><a href="http://researchblogging.org/news/?p=3210"><img alt="This post was chosen as an Editor's Selection for ResearchBlogging.org" src="https://i1.wp.com/www.researchblogging.org/public/citation_icons/rb_editors-selection.png" style="border: 0;"/></a></span>I’ve posted twice about Anonymous hacking into Stratfor — and, more generally, their hacktivism has been making bigger and bigger waves.  CNN recently ran <a href="https://www.youtube.com/watch?v=NUZ81QiX76Q">a fairly positive story</a> on the support hacktivists are providing the Occupy movement.  Many of these hacktivists are quite active on Twitter and elsewhere.  However, from the perspective of both international and corporate espionage, the “quiet” hacks are the worst: someone makes off with information and the victim never knows.  As security expert Kevin Mandia <a href="https://www.nytimes.com/2011/12/30/technology/hacker-attacks-like-stratfors-require-fast-response.html?_r=1">told the New York Times</a>:</p>
<blockquote><p>The hacks that do the most damage don’t have Twitter feeds.</p></blockquote>
<p>Another security expert, Jeremy Falkenrath, in <a href="http://www.bloomberg.com/video/83389600/">an interview on Bloomberg News </a>(at about 7:00 into the video), discussed, quite matter-of-factly, the hacker-for-hire market that companies in the chemical industry deploy against one another to learn trade secrets.  With this as the backdrop, I’d like to discuss one of the main open questions of cheminformatics: <em>Is secure encryption of molecules possible?  </em>For example, it would be nice if a company could encrypt a molecule, but then allow some third party to run <em>in silico</em> tests with it, having access to the molecule’s properties but not the structure itself.<em><br/>
</em></p>
<p><strong>Encryption of molecules</strong></p>
<p>Part of the reason for the traditional closed-data policies of pharmaceutical companies is the total absence of any way to encrypt chemical structural information.  This has been recognized as an open problem for many years, the American Chemical Society held a special meeting in 2005 about it, <a href="http://www.nature.com/nrd/journal/v4/n3/full/nrd1683.html">a summary of which</a> appeared in Nature.  While there were presenters at that meeting who felt molecular encryption was possible, and others who felt it was impossible, the practical reality as we enter 2012 is that, so far, the voices in favor of “impossible” have been correct.  Almost no new theoretical literature has been produced since 2005, and the industry appears no nearer a practical solution than it was in, say, 1975.</p>
<p>I recently had an idea to expand upon a proposal by Eggers et al. in 2001, to watermark <em>in silico</em> representations of molecules.  My idea, however, is going nowhere — just like all other attempts so far to implement chemical watermarking.  At least I can get a blog entry out of my failure though!  I hope readers of this page find my little attempt entertaining or informative.</p>
<p><strong>Acknowledgement</strong>: The material in this post is based on conversations I have had with cheminformaticians Rajarshi Guha and Jörg Kurt Wegner.</p>
<p><span id="more-687"/></p>
<p><strong>Watermarking molecules</strong></p>
<p>A <a href="https://en.wikipedia.org/wiki/Digital_watermarking">digital watermark</a>, of course, is a special code embedded into a file so that its provenance can be determined.  The file has to be large enough so that perturbations to individual data points are not feasibly discoverable to a would-be forger, even though there are enough data points to produce a unique fingerprint for that file, at least with high probability.  In 2001, Eggers et al. published <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.62.9842">Digital Watermarking of Chemical Structure Sets</a>, which proposed the use of <a href="http://www.stanford.edu/~bgirod/pdfs/EggersTrans_SP2003.pdf">SCS watermarking</a> on databases of molecules, so that the company that had created or owned the molecules would be able to prove that another company’s claim to independent discovery was, in fact, infringement.</p>
<p>A single molecule is not large enough to embed an indiscernible watermark, which is why Eggers et al. considered “structure sets” — a large list of molecules that are somehow related.  Technically, each molecule is considered as a graph embedded into three-dimensional space.  (In fact, this graph may be the “reduced graph,” or a graph of the molecule with all hydrogen atoms removed, because reduced graphs performed better on one empirical test in their study.)  I will ignore a lot of technical details here, but the core idea behind their watermarking process is to perturb the 3D coordinate of specially-chosen atoms by a small, “random-appearing” amount.  If enough locations of atoms in the structure set are modified this way, it produces a digital watermark.</p>
<p>More interesting to me than the watermarking method was the list of potential attacks Eggers et al. considered.  If the attacker can do <em>anything</em>, it is famously difficult to encrypt data while still providing functionality.  However, we are working in the chemistry domain.  On the one hand, this adds technical obstacles (due to “real-world messiness”), but, on the other hand, it may limit the attacks that can be performed on the system, since the attackers need to obtain a structure that is chemically useful, not just some fragment of plaintext.  Eggers et al. tried to provide a watermarking method resilient to the following attacks.</p>
<ul>
<li>Removal of data from the original dataset.</li>
<li>Injection of non-watermarked structures into the dataset.</li>
<li>Reordering of individual records in the dataset.</li>
<li>Reordering of atoms and bonds in the structure records.</li>
<li>Global 3D transforms, e.g., rotations or translations.</li>
<li>Changes of structural notation conventions.</li>
<li>Removal of hydrogen atoms from structures.</li>
</ul>
<p><strong>My new idea and why it fails</strong></p>
<p>I will cut to the chase and explain why my idea doesn’t work — and why, perhaps, no watermarking concept is feasible in the chemical domain.  Then I will conclude, anticlimactically, by describing my idea, in case someone can get something out of it.</p>
<p>Consider the domain of music piracy.  The attacker can hear the music, and perhaps even has access to guitar tabs or a symphony score.  However, it would not be cost-benefit for the attacker to hire a brand-new orchestra to re-record the original piece of music — and, even if the attacker did that, the new track would not sound exactly the same.  By contrast, in chemistry, every carbon atom is identical to every other carbon atom.  So in the case of a chemikcal structure set, the attacker could choose a molecule(s) of interest, and then just rebuild the structure from scratch, and use the 3D coordinates (and all other information) from the brand new molecule.  Presto, no watermark.</p>
<p>Eggers et al. consider this attack, sort of.  They say:</p>
<blockquote><p>We assume that no unlicensed copies of the software used to generate the original protected dataset are provided in circulation.  Furthermore, the computation time for large datasets in often significant.  Depending on the type of algorithm used and the size of the dataset, it can be up to several CPU months.  Thus, simple regeneration of the data is often not a feasible approach.</p></blockquote>
<p>While the claim about significant recomputation time may have been true in 2001, it no longer appears to be.  As one chemist said to me, recomputation of a molecular structure “wouldn’t be hard at all.”  This leaves the only defense of a watermark the unavailability of licensed software to perform the recomputation.  That, however, relies on an attacker who is willing to perform industrial espionage but who draws the line at software piracy.  So, no go.</p>
<p>Now we get to my idea.  In the field of image processing there has been a lot of work since 2001 on 3D watermarking.  One survey is <a href="http://www.springerlink.com/content/m117v1517384r181/">3D Watermarking: Techniques and Directions</a>, by Koz et al., which considers strengths and weaknesses of many different watermarking techniques.  One method that caught my eye was <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.59.7597&amp;rep=rep1&amp;type=pdf">Robust Image Watermarking Based on Generalized Radon Transformations</a>, by Simitopolous et al., because it is specifically designed to be resistant to “geometric attacks” like rotation, scaling, translaton and cropping, which closely follow the list of anticipated attacks in the Eggers et al. paper.  Applying this to chemistry might provide a much better watermarking tool than the more generic watermarking method chosen by Eggers et al.</p>
<p>However, I’ve decided not to consider this further, because it seems that the most I could get out of it would be a paper that would be theoretically “cute,” with no chance of being practical, ever.  I would love to be proven wrong, so if you can think of a way to get around the “rebuild the molecule from scratch” attack, please do comment.  In the meantime, I am on to other things.</p>
<p><span style="float: left; padding: 5px;"><a href="http://www.researchblogging.org"><img alt="ResearchBlogging.org" src="https://i1.wp.com/www.researchblogging.org/public/citation_icons/rb2_tiny.png" style="border: 0;"/></a></span> <span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.jtitle=Information+Hiding&amp;rft_id=info%3Adoi%2F10.1007%2F3-540-45496-9_15&amp;rfr_id=info%3Asid%2Fresearchblogging.org&amp;rft.atitle=Digital+Watermarking+of+Chemical+Structure+Sets&amp;rft.issn=&amp;rft.date=2001&amp;rft.volume=&amp;rft.issue=&amp;rft.spage=200&amp;rft.epage=214&amp;rft.artnum=http%3A%2F%2Fwww.springerlink.com%2Fcontent%2Fye6vt84eqneb96j2%2F&amp;rft.au=Joachim+J.+Eggers&amp;rft.au=W.D.+Ihlenfeldt&amp;rft.au=Bern+Girod&amp;rfe_dat=bpr3.included=1;bpr3.tags=Chemistry%2CComputer+Science+%2F+Engineering%2CEncryption%2C+Cheminformatics">Joachim J. Eggers, W.D. Ihlenfeldt, &amp; Bernd Girod (2001). Digital Watermarking of Chemical Structure Sets <span style="font-style: italic;">Information Hiding</span>, 200-214 DOI: <a href="http://dx.doi.org/10.1007/3-540-45496-9_15" rev="review">10.1007/3-540-45496-9_15</a></span></p></div></content><updated planet:format="January 27, 2012 03:00 PM">2012-01-27T15:00:46Z</updated><published planet:format="January 27, 2012 03:00 PM">2012-01-27T15:00:46Z</published><category term="Uncategorized"/><category term="cheminformatics"/><category term="chemoinformatics"/><category term="cryptography"/><author><name>Aaron Sterling</name></author><source><id>https://nanoexplanations.wordpress.com</id><logo>https://s0.wp.com/i/buttonw-com.png</logo><link href="https://nanoexplanations.wordpress.com/feed/" rel="self" type="application/atom+xml"/><link href="https://nanoexplanations.wordpress.com" rel="alternate" type="text/html"/><link href="https://nanoexplanations.wordpress.com/osd.xml" rel="search" type="application/opensearchdescription+xml"/><link href="https://nanoexplanations.wordpress.com/?pushpress=hub" rel="hub" type="text/html"/><subtitle>the blog of Aaron Sterling</subtitle><title>Nanoexplanations</title><updated planet:format="December 17, 2018 05:29 AM">2018-12-17T05:29:46Z</updated><planet:module>toc</planet:module><planet:format>atom10</planet:format><planet:http_last_modified>Thu, 12 Apr 2018 01:29:57 GMT</planet:http_last_modified><planet:bozo>false</planet:bozo><planet:items_per_page>40</planet:items_per_page><planet:css-id>aaron-sterling</planet:css-id><planet:face>sterling.jpeg</planet:face><planet:name>Aaron Sterling</planet:name><planet:http_location>https://nanoexplanations.wordpress.com/feed/</planet:http_location><planet:http_status>301</planet:http_status></source></entry>
