<?xml version="1.0" encoding="utf-8"?><entry xml:lang="en-US" xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>https://blogs.princeton.edu/imabandit/?p=1346</id><link href="https://blogs.princeton.edu/imabandit/2018/11/21/a-short-proof-for-nesterovs-momentum/" rel="alternate" type="text/html"/><title>A short proof for Nesterov’s momentum</title><summary type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><p>Yesterday I posted the following picture on Twitter and it quickly became my most visible tweet ever (by far):     I thought this would be a good opportunity to revisit the proof of Nesterov’s momentum, especially since as it … <a href="https://blogs.princeton.edu/imabandit/2018/11/21/a-short-proof-for-nesterovs-momentum/">Continue reading <span class="meta-nav">→</span></a></p></div><div class="commentbar"><p/></div></summary><content type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><p>Yesterday I posted <a class="liinternal" href="https://twitter.com/SebastienBubeck/status/1065024570309042176">the following picture</a> on Twitter and it quickly became my most visible tweet ever (by far):</p>
<p class="ql-center-displayed-equation" style="line-height: 155px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\begin{eqnarray*} &amp; x^+ := x - \eta \nabla f(x) &amp; \text{(gradient step)} \\ &amp; d_t := \gamma_t \cdot (x_{t} - x_{t-1}) &amp; \text{(momentum term)} \\ \\ \text{ [Cauchy, 1847] } &amp; x_{t+1} = x_t^+ &amp; \text{(gradient descent)} \\ \text{ [Polyak, 1964] } &amp; x_{t+1} = x_t^+ + d_{t} &amp; \text{(momentum + gradient)} \\ \text{ [Nesterov, 1983] } &amp; x_{t+1} = (x_t + d_{t})^+ &amp; \text{(momentum + lookahead gradient)} \end{eqnarray*}" class="ql-img-displayed-equation " height="155" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-d2bae84ef1d0f3d68395b2753051452d_l3.png?resize=589%2C155&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="589"/></p>
<p>I thought this would be a good opportunity to revisit the proof of Nesterov’s momentum, especially since as it turns out I really don’t like the way I described it <a class="liinternal" href="https://blogs.princeton.edu/imabandit/2013/04/01/acceleratedgradientdescent/">back in 2013</a> (and to this day the latter post also remains my most visible post ever…). So here we go, for what is hopefully a short and intuitive proof of the <img alt="1/t^2" class="ql-img-inline-formula " height="20" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-cd0c1962105a4d25ae10283b6102d5e7_l3.png?resize=30%2C20&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="30"/> convergence rate for Nesterov’s momentum (disclaimer: this proof is merely a rearranging of well-known calculations, nothing new is going on here).</p>
<p>We assume that <img alt="f" class="ql-img-inline-formula " height="16" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-c7d97b919a3b73617cf2fbb375fff3b1_l3.png?resize=10%2C16&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="10"/> is <img alt="\beta" class="ql-img-inline-formula " height="16" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-874e8d85c668e484f7277da3d75ce10e_l3.png?resize=11%2C16&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="11"/>-smooth convex function, and we take <img alt="\eta = 1/\beta" class="ql-img-inline-formula " height="18" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-c22ff34deb301bf7b54eaa30c554a872_l3.png?resize=62%2C18&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="62"/> in the gradient step. The momentum term <img alt="\gamma_t" class="ql-img-inline-formula " height="12" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-489a425d5327168dba48971817ba248e_l3.png?resize=14%2C12&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="14"/> will be set to a very particular value, which comes out naturally in the proof.</p>
<p> </p>
<p><strong>The two basic inequalities</strong></p>
<p>Let us denote <img alt="\delta_t = f(x_t) - f(x^*)" class="ql-img-inline-formula " height="18" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-03e5c2b1b5ca95f13de6f228ea9ad27c_l3.png?resize=141%2C18&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="141"/> and <img alt="g_t = - \frac{1}{\beta} \nabla f(x_t + d_t)" class="ql-img-inline-formula " height="25" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-f3e2fbe422fdee3fa63839629f24f09a_l3.png?resize=155%2C25&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="155"/> (note that <img alt="x_{t+1} = x_t + g_t + d_t" class="ql-img-inline-formula " height="18" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-14f53a34ec75692ebeb7979c4b789e0b_l3.png?resize=145%2C18&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="145"/>). Now let us write our favorite inequalities (using <img alt="f(x^+) - f(x) \leq - \frac{1}{2 \beta} |\nabla f(x)|^2" class="ql-img-inline-formula " height="25" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-6c0cf4bdbacb7b59c2f14a4c6c939d71_l3.png?resize=225%2C25&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="225"/> and <img alt="f(x) - f(y) \leq \nabla f(x) \cdot (x-y)" class="ql-img-inline-formula " height="18" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-1e5ece4005951fee2314a4aa9fc0b472_l3.png?resize=230%2C18&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="230"/>):</p>
<p class="ql-center-displayed-equation" style="line-height: 36px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\[ \delta_{t+1} - \delta_t \leq - \frac{\beta}{2} \left( |g_t|^2 + 2 g_t \cdot d_t \right) \,, \]" class="ql-img-displayed-equation " height="36" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-2f2a79eecb14e19584aa14a21015245c_l3.png?resize=253%2C36&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="253"/></p>
<p>and</p>
<p class="ql-center-displayed-equation" style="line-height: 36px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\[ \delta_{t+1} \leq - \frac{\beta}{2} \left( |g_t|^2 + 2 g_t \cdot (x_t + d_t - x^*) \right) \,. \]" class="ql-img-displayed-equation " height="36" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-dfb5d94574f3f51e375702a6aa2273a3_l3.png?resize=308%2C36&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="308"/></p>
<p> </p>
<p><strong>On the way to a telescopic sum</strong></p>
<p>Recall now that <img alt="|a|^2 + 2 a \cdot b = |a+b|^2 - |b|^2" class="ql-img-inline-formula " height="19" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-f9a7eb15608470b13b9314248a7ff3aa_l3.png?resize=212%2C19&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="212"/>, so it would be nice to somehow combine the two above inequalities to obtain a telescopic sum thanks to this simple formula. Let us try to take a convex combination of the two inequalities. In fact it will be slightly more elegant if we use the coefficient <img alt="1" class="ql-img-inline-formula " height="13" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-21b5b4cbe9a10b6d847eeb4265b99898_l3.png?resize=7%2C13&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="7"/> on the second inequality, so let us do <img alt="\lambda_t-1" class="ql-img-inline-formula " height="15" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-1a681cd9587084897fd82bc5a2b7e5c9_l3.png?resize=46%2C15&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="46"/> times the first inequality plus <img alt="1" class="ql-img-inline-formula " height="13" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-21b5b4cbe9a10b6d847eeb4265b99898_l3.png?resize=7%2C13&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="7"/> times the second inequality. We obtain an inequality whose right hand side is given by <img alt="-\frac{\beta}{2}" class="ql-img-inline-formula " height="23" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-3c4a581d257fd68c4d9c37a1c333db77_l3.png?resize=24%2C23&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="24"/> times</p>
<p class="ql-center-displayed-equation" style="line-height: 68px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\begin{align*} &amp; \lambda_t |g_t|^2 + 2 g_t \cdot (x_t + \lambda_t d_t - x^*) \\ &amp; = \frac{1}{\lambda_t} \left( |x_t + \lambda_t d_t - x^* + \lambda_t g_t|^2 - |x_t + \lambda_t d_t - x^*|^2 \right) \,. \end{align*}" class="ql-img-displayed-equation " height="68" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-add8691a09d680d0a59cb09eec7035d7_l3.png?resize=398%2C68&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="398"/></p>
<p>Recall that our objective is to obtain a telescopic sum, and at this point we still have flexibility both to choose <img alt="\lambda_t" class="ql-img-inline-formula " height="15" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-9c908ff5ec1398a4aa9a734884c60e9f_l3.png?resize=15%2C15&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="15"/> and <img alt="\gamma_t" class="ql-img-inline-formula " height="12" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-489a425d5327168dba48971817ba248e_l3.png?resize=14%2C12&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="14"/>. What we would like to have is:</p>
<p class="ql-center-displayed-equation" style="line-height: 19px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\[ x_t + \lambda_t d_t - x^* + \lambda_t g_t = x_{t+1} + \lambda_{t+1} d_{t+1} - x^* \,. \]" class="ql-img-displayed-equation " height="19" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-77cfa389a4eb920bef5425d09daa5b58_l3.png?resize=351%2C19&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="351"/></p>
<p>Observe that (since <img alt="d_{t+1} = \gamma_{t+1} \cdot (d_t + g_t)" class="ql-img-inline-formula " height="19" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-69c333126c30e13c3fefe93cf84ba8ad_l3.png?resize=165%2C19&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="165"/>) the right hand side can be written as <img alt="x_t + g_t + d_t + \lambda_{t+1} \cdot \gamma_{t+1} \cdot (g_t + d_t) - x^*" class="ql-img-inline-formula " height="19" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-050a336154e2cb8ba78338c7e4ffa1ad_l3.png?resize=304%2C19&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="304"/>, and thus we see that we simply need to have:</p>
<p class="ql-center-displayed-equation" style="line-height: 16px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\[ \lambda_t = 1+ \lambda_{t+1} \cdot \gamma_{t+1} \,. \]" class="ql-img-displayed-equation " height="16" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-30b8c3be1d67f3c4a9e795cd89505a08_l3.png?resize=157%2C16&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="157"/></p>
<p> </p>
<p><strong>Setting the parameters and concluding the proof</strong></p>
<p>Writing <img alt="u_t := \frac{\beta}{2} |x_t + \lambda_t d_t - x^*|^2" class="ql-img-inline-formula " height="23" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-a738d10d455ab56707e24cda611ff4d0_l3.png?resize=182%2C23&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="182"/> we now obtain as a result of the combination of our two starting inequalities:</p>
<p class="ql-center-displayed-equation" style="line-height: 21px;"><span class="ql-right-eqno">   </span><span class="ql-left-eqno">   </span><img alt="\[ \lambda_t^2 \delta_{t+1} - (\lambda_t^2 - \lambda_t) \delta_t \leq u_t - u_{t+1} \,. \]" class="ql-img-displayed-equation " height="21" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-07e4430c91aa1bd339a32f5c5fbfa3cc_l3.png?resize=256%2C21&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="256"/></p>
<p>It only remains to select <img alt="\lambda_t" class="ql-img-inline-formula " height="15" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-9c908ff5ec1398a4aa9a734884c60e9f_l3.png?resize=15%2C15&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="15"/> such that <img alt="\lambda_t^2 - \lambda_t = \lambda_{t-1}^2" class="ql-img-inline-formula " height="21" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-a396a25828ab399221e589f0faa64875_l3.png?resize=111%2C21&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="111"/> (i.e., roughly <img alt="\lambda_t" class="ql-img-inline-formula " height="15" src="https://i1.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-9c908ff5ec1398a4aa9a734884c60e9f_l3.png?resize=15%2C15&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="15"/> is of order <img alt="t" class="ql-img-inline-formula " height="12" src="https://i2.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-6b97bb0f65c75b6cc0fba1868749478d_l3.png?resize=6%2C12&amp;ssl=1" style="vertical-align: 0px;" title="Rendered by QuickLaTeX.com" width="6"/>) so that by summing the previous inequality one obtains <img alt="\delta_{t+1} \leq \frac{\beta |x_1 - x^*|^2}{2 \lambda_t^2}" class="ql-img-inline-formula " height="30" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-0ad08a0fcdfd8cb6ec6f7f579b5dc417_l3.png?resize=120%2C30&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="120"/> which is exactly the <img alt="1/t^2" class="ql-img-inline-formula " height="20" src="https://i0.wp.com/blogs.princeton.edu/imabandit/wp-content/ql-cache/quicklatex.com-cd0c1962105a4d25ae10283b6102d5e7_l3.png?resize=30%2C20&amp;ssl=1" title="Rendered by QuickLaTeX.com" width="30"/> rate we were looking for.</p></div></content><updated planet:format="November 21, 2018 07:59 PM">2018-11-21T19:59:45Z</updated><published planet:format="November 21, 2018 07:59 PM">2018-11-21T19:59:45Z</published><category term="Optimization"/><author><name>Sebastien Bubeck</name></author><source><id>https://blogs.princeton.edu/imabandit</id><link href="https://blogs.princeton.edu/imabandit/feed/" rel="self" type="application/atom+xml"/><link href="https://blogs.princeton.edu/imabandit" rel="alternate" type="text/html"/><subtitle>Random topics in optimization, probability, and statistics. By Sébastien Bubeck</subtitle><title>I’m a bandit</title><updated planet:format="December 16, 2018 04:44 PM">2018-12-16T16:44:02Z</updated><planet:http_status>200</planet:http_status><planet:module>toc</planet:module><planet:format>atom10</planet:format><planet:items_per_page>40</planet:items_per_page><planet:name>S&amp;eacute;bastian Bubeck</planet:name><planet:http_last_modified>Fri, 23 Nov 2018 17:03:44 GMT</planet:http_last_modified><planet:bozo>false</planet:bozo><planet:http_etag>&quot;7a21033bc747c1eccfdc0e4c416aa3e2&quot;</planet:http_etag><planet:css-id>s-eacute-bastian-bubeck</planet:css-id></source></entry>
