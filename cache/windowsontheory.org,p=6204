<?xml version="1.0" encoding="utf-8"?><entry xml:lang="en" xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>http://windowsontheory.org/?p=6204</id><link href="https://windowsontheory.org/2018/09/15/statistical-physics-an-introduction-in-two-parts/" rel="alternate" type="text/html"/><title>Statistical Physics: an introduction in two parts</title><summary>Statistical physics has deep connections to many computational problems, including statistical inference, counting and sampling, and optimization. Perhaps especially compelling are the field’s insights and intuitions regarding “average-case complexity” and information-computation gaps. These are topics for which the traditional theoretical CS approaches seem ill-suited, while on the other hand statistical physics has supplied a rich […]<div class="commentbar"><p/></div></summary><content type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><p>Statistical physics has deep connections to many computational problems, including statistical inference, counting and sampling, and optimization. Perhaps especially compelling are the field’s insights and intuitions regarding “average-case complexity” and information-computation gaps. These are topics for which the traditional theoretical CS approaches seem <a href="http://www.cse.cuhk.edu.hk/~andrejb/pubs/average-now.pdf">ill-suited</a>, while on the other hand statistical physics has supplied a rich (albeit not always mathematically rigorous) theory.</p>
<p>Statistical physics is the first topic in the <a href="https://www.boazbarak.org/fall18seminar/">seminar course</a> I am co-teaching with Boaz this fall, and one of our primary goals is to explore this theory. This blog post is a re-working of a lecture I gave in class this past Friday. It is meant to serve as an introduction to statistical physics, and is composed of two parts: in the first part, I introduce the basic concepts from statistical physics in a hands-on manner, by demonstrating a phase transition for the Ising model on the complete graph. In the second part, I introduce random k-SAT and the satisfiability conjecture, and give some moment-method based proofs of bounds on the satisfiability threshold.</p>
<p><span style="color: #999999;"><em>Update on September 16, 3:48pm: the first version of this post contained an incorrect plot of the energy density of the Ising model on the complete graph, which I have amended below.</em></span></p>
<h2>I. From particle interactions to macroscopic behaviors</h2>
<p>In statistical physics, the goal is to understand how materials behave on a macroscopic scale based on a simple model of particle-particle interactions.</p>
<p>For example, consider a block of iron. In a block of iron, we have many iron particles, and each has a net <img alt="\{\pm 1\}" class="latex" src="https://s0.wp.com/latex.php?latex=%5C%7B%5Cpm+1%5C%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\{\pm 1\}"/>-polarization or “spin” which is induced by the quantum spins of its unpaired electrons. On the microscopic scale, nearby iron atoms “want” to have the same spin. From what I was able to gather on <a href="https://en.wikipedia.org/wiki/Ferromagnetism#Explanation" title="Explanation of Ferromagnetism">Wikipedia</a>, this is because the unpaired electrons in the distinct iron atoms repel each other, and if two nearby iron atoms have the same spins, then this allows them to be in a physical configuration where the atoms are further apart in space, which results in a <strong>lower energy state</strong> (because of the repulsion between electrons).</p>
<p>When most of the particles in a block of iron have correlated spins, then on a macroscopic scale we observe this correlation as the phenomenon of magnetism (or ferromagnetism if we want to be technically correct).</p>
<p>In the 1890’s, Pierre Curie showed that if you heat up a block of iron (introducing energy into the system), it eventually loses its magnetization. In fact, magnetization exhibits a <strong>phase transition</strong>: there is a critical temperature, <img alt="T_c" class="latex" src="https://s0.wp.com/latex.php?latex=T_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T_c"/>, below which a block of iron will act as a magnet, and above which it will suddenly lose its magnetism. This is called the “Curie temperature”. This phase transition is in contrast to the alternative, in which the iron would gradually lose its magnetization as it is heated.</p>
<p><img alt="trans" class="alignnone size-full wp-image-6217" src="https://windowsontheory.files.wordpress.com/2018/09/trans.png?w=600"/></p>
<h3>The Ising Model</h3>
<p>We’ll now set up a simple model of the microscopic particle-particle interactions, and see how the global phenomenon of the magnetization phase transition emerges. This is called the <em>Ising model</em>, and it is one of the more canonical models in statistical physics.</p>
<p>Suppse that we have <img alt="n" class="latex" src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n"/> iron atoms, and that their interactions are described by the (for simplicity unweighted) graph <img alt="G" class="latex" src="https://s0.wp.com/latex.php?latex=G&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="G"/> with adjacency matrix <img alt="A_G" class="latex" src="https://s0.wp.com/latex.php?latex=A_G&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="A_G"/>. For example, we may think of the atoms as being arranged in a 3D cubic lattice, and then <img alt="G" class="latex" src="https://s0.wp.com/latex.php?latex=G&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="G"/> would be the 3D cubic lattice graph. We give each atom a label in <img alt="[n] = \{1,\ldots,n\}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Bn%5D+%3D+%5C%7B1%2C%5Cldots%2Cn%5C%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="[n] = \{1,\ldots,n\}"/>, and we associate with each atom <img alt="i \in [n]" class="latex" src="https://s0.wp.com/latex.php?latex=i+%5Cin+%5Bn%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="i \in [n]"/> a spin <img alt="x_i \in \{\pm 1\}" class="latex" src="https://s0.wp.com/latex.php?latex=x_i+%5Cin+%5C%7B%5Cpm+1%5C%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x_i \in \{\pm 1\}"/>.</p>
<p>For each choice of spins or <em>state</em> <img alt="x \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \{\pm 1\}^n"/> we associate the <em>total energy</em></p>
<p><img alt="E(x) = - x^\top A_G x= \sum_{(i,j) \in G} - x_i x_j" class="latex" src="https://s0.wp.com/latex.php?latex=E%28x%29+%3D+-+x%5E%5Ctop+A_G+x%3D+%5Csum_%7B%28i%2Cj%29+%5Cin+G%7D+-+x_i+x_j&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="E(x) = - x^\top A_G x= \sum_{(i,j) \in G} - x_i x_j"/>.</p>
<p>If two interacting particles have the same spin, then they are in a “lower energy” configuration, and then they contribute <img alt="-1" class="latex" src="https://s0.wp.com/latex.php?latex=-1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="-1"/> to the total energy. If two neighboring particles have opposite spins, then they are in a “higher energy” configuration, and they contribute <img alt="+1" class="latex" src="https://s0.wp.com/latex.php?latex=%2B1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="+1"/> to the total energy.</p>
<p>We also introduce a <em>temperature</em> parameter <img alt="T" class="latex" src="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T"/>. At each <img alt="T" class="latex" src="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T"/>, we want to describe what a “typical” configuration for our block of iron looks like. When <img alt="T=0" class="latex" src="https://s0.wp.com/latex.php?latex=T%3D0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T=0"/>, there is no kinetic energy in the system, so we expect the system to be in the lowest-energy state, i.e. all atoms have the same spin. As the temperature increases, the kinetic energy also increases, and we will begin to see more anomalies.</p>
<p>In statistical physics, the “description” takes the form of a probability distribution over states <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/>. To this end we define the <em>Boltzmann distribution</em>, with density function <img alt="P_{\beta}(x)" class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}(x)"/>:</p>
<p><img alt="P_{\beta}(x) \propto \exp(-\beta E(x)), \qquad \text{where } \beta = \frac{1}{T}." class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D%28x%29+%5Cpropto+%5Cexp%28-%5Cbeta+E%28x%29%29%2C+%5Cqquad+%5Ctext%7Bwhere+%7D+%5Cbeta+%3D+%5Cfrac%7B1%7D%7BT%7D.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}(x) \propto \exp(-\beta E(x)), \qquad \text{where } \beta = \frac{1}{T}."/></p>
<p>As <img alt="T\to 0" class="latex" src="https://s0.wp.com/latex.php?latex=T%5Cto+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T\to 0"/>, <img alt="\beta\to\infty" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta%5Cto%5Cinfty&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta\to\infty"/>, <img alt="P_{\beta}(x)" class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}(x)"/> becomes supported entirely on the <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> that minimize <img alt="E(x)" class="latex" src="https://s0.wp.com/latex.php?latex=E%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="E(x)"/>; we call these the <em>ground states</em> (for connected <img alt="G" class="latex" src="https://s0.wp.com/latex.php?latex=G&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="G"/> these are exactly <img alt="x = \pm \vec{1}" class="latex" src="https://s0.wp.com/latex.php?latex=x+%3D+%5Cpm+%5Cvec%7B1%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x = \pm \vec{1}"/>). On the other hand as <img alt="T \to \infty, \beta \to 0" class="latex" src="https://s0.wp.com/latex.php?latex=T+%5Cto+%5Cinfty%2C+%5Cbeta+%5Cto+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T \to \infty, \beta \to 0"/>, all <img alt="x \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \{\pm 1\}^n"/> are weighted equally according to <img alt="P_{\beta}" class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}"/>.</p>
<p>Above we have defined the Boltzmann distribution to be proportional to <img alt="\exp(-\beta E(x))" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cexp%28-%5Cbeta+E%28x%29%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\exp(-\beta E(x))"/>. To spell it out,</p>
<p><img alt="P_{\beta}(x) = \frac{1}{Z(\beta)} \exp(-\beta E(x)), \qquad \text{where } Z(\beta) = \sum_{x \in \{\pm 1\}^n} \exp(-\beta E(x))." class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D%28x%29+%3D+%5Cfrac%7B1%7D%7BZ%28%5Cbeta%29%7D+%5Cexp%28-%5Cbeta+E%28x%29%29%2C+%5Cqquad+%5Ctext%7Bwhere+%7D+Z%28%5Cbeta%29+%3D+%5Csum_%7Bx+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En%7D+%5Cexp%28-%5Cbeta+E%28x%29%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}(x) = \frac{1}{Z(\beta)} \exp(-\beta E(x)), \qquad \text{where } Z(\beta) = \sum_{x \in \{\pm 1\}^n} \exp(-\beta E(x))."/></p>
<p>The normalizing quantity <img alt="Z(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\beta)"/> is referred to as the <em>partition function</em>, and is interesting in its own right. For example, from <img alt="Z(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\beta)"/> we can compute the <em>free energy</em> <img alt="F(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=F%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="F(\beta)"/> of the system, as well as the <em>internal energy</em> <img alt="U(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=U%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="U(\beta)"/> and the <em>entropy</em> <img alt="S(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=S%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="S(\beta)"/>:</p>
<p><img alt="F(\beta) = -\frac{1}{\beta} \ln Z(\beta), \qquad \qquad U(\beta) = \frac{\partial}{\partial \beta} (\beta F(\beta)), \qquad \qquad S(\beta) = \beta^2 \frac{\partial}{\partial \beta} F(\beta)." class="latex" src="https://s0.wp.com/latex.php?latex=F%28%5Cbeta%29+%3D+-%5Cfrac%7B1%7D%7B%5Cbeta%7D+%5Cln+Z%28%5Cbeta%29%2C+%5Cqquad+%5Cqquad+U%28%5Cbeta%29+%3D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Cbeta%7D+%28%5Cbeta+F%28%5Cbeta%29%29%2C+%5Cqquad+%5Cqquad+S%28%5Cbeta%29+%3D+%5Cbeta%5E2+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Cbeta%7D+F%28%5Cbeta%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="F(\beta) = -\frac{1}{\beta} \ln Z(\beta), \qquad \qquad U(\beta) = \frac{\partial}{\partial \beta} (\beta F(\beta)), \qquad \qquad S(\beta) = \beta^2 \frac{\partial}{\partial \beta} F(\beta)."/></p>
<p>Using some straightforward calculus, we can then see that <img alt="S(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=S%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="S(\beta)"/> is the Shannon entropy,</p>
<p><img alt="S(\beta) = - \sum_{x} P_{\beta}(x)\ln (P_{\beta}(x))," class="latex" src="https://s0.wp.com/latex.php?latex=S%28%5Cbeta%29+%3D+-+%5Csum_%7Bx%7D+P_%7B%5Cbeta%7D%28x%29%5Cln+%28P_%7B%5Cbeta%7D%28x%29%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="S(\beta) = - \sum_{x} P_{\beta}(x)\ln (P_{\beta}(x)),"/></p>
<p>that <img alt="U(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=U%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="U(\beta)"/> is the average energy in the system,</p>
<p><img alt="U(\beta) = \sum_{x} P_{\beta}(x) \cdot E(x)," class="latex" src="https://s0.wp.com/latex.php?latex=U%28%5Cbeta%29+%3D+%5Csum_%7Bx%7D+P_%7B%5Cbeta%7D%28x%29+%5Ccdot+E%28x%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="U(\beta) = \sum_{x} P_{\beta}(x) \cdot E(x),"/></p>
<p>and that the free energy is the difference of the internal energy and the product of the temperature <img alt="T = \frac{1}{\beta}" class="latex" src="https://s0.wp.com/latex.php?latex=T+%3D+%5Cfrac%7B1%7D%7B%5Cbeta%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T = \frac{1}{\beta}"/> and the entropy,</p>
<p><img alt="F(\beta) = U(\beta) - T \cdot S(\beta)," class="latex" src="https://s0.wp.com/latex.php?latex=F%28%5Cbeta%29+%3D+U%28%5Cbeta%29+-+T+%5Ccdot+S%28%5Cbeta%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="F(\beta) = U(\beta) - T \cdot S(\beta),"/></p>
<p>just like the <a href="https://en.wikipedia.org/wiki/Gibbs_free_energy">classical thermodynamic definitons</a>!</p>
<h3>Why these functions?</h3>
<p>The free energy, internal energy, and entropy encode information about the typical behavior of the system at temperature <img alt="\beta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta"/>. We can get some intuition by considering the extremes, <img alt="\beta \to \infty" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cto+%5Cinfty&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \to \infty"/> and <img alt="\beta \to 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cto+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \to 0"/>.</p>
<p>In cold systems with <img alt="\beta \to \infty" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cto+%5Cinfty&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \to \infty"/>, if we let <img alt="E_0" class="latex" src="https://s0.wp.com/latex.php?latex=E_0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="E_0"/> be the energy of the ground state, <img alt="N_0 = |\{x : E(x) = E_0\}|" class="latex" src="https://s0.wp.com/latex.php?latex=N_0+%3D+%7C%5C%7Bx+%3A+E%28x%29+%3D+E_0%5C%7D%7C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="N_0 = |\{x : E(x) = E_0\}|"/> be the number of ground state configurations, and <img alt="\Delta_E = \min_{x : E(x) \textgreater E_0} E(x) - E_0" class="latex" src="https://s0.wp.com/latex.php?latex=%5CDelta_E+%3D+%5Cmin_%7Bx+%3A+E%28x%29+%5Ctextgreater+E_0%7D+E%28x%29+-+E_0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Delta_E = \min_{x : E(x) \textgreater E_0} E(x) - E_0"/> be the energy gap, then</p>
<p><img alt="Z(\beta) = N_0 \exp(-\beta E_0)\cdot\left(1 + O\left(\exp(-\beta \Delta_E)\right)\right)," class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cbeta%29+%3D+N_0+%5Cexp%28-%5Cbeta+E_0%29%5Ccdot%5Cleft%281+%2B+O%5Cleft%28%5Cexp%28-%5Cbeta+%5CDelta_E%29%5Cright%29%5Cright%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\beta) = N_0 \exp(-\beta E_0)\cdot\left(1 + O\left(\exp(-\beta \Delta_E)\right)\right),"/></p>
<p>where the <img alt="O(\cdot)" class="latex" src="https://s0.wp.com/latex.php?latex=O%28%5Ccdot%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="O(\cdot)"/> notation hides factors that do not depend on <img alt="\beta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta"/>. From this it isn’t hard to work out that</p>
<p><img alt="\begin{aligned} F(\beta) &amp;= E_0 -\frac{1}{\beta} \ln(N_0) + O\left(\exp(-\beta \Delta_E)\right),\\ E(\beta) &amp;= E_0 + O\left(\exp(-\beta \Delta_E)\right)\\ S(\beta) &amp;= \ln N_0 + O\left(\exp(-\beta \Delta_E)\right). \end{aligned}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D+F%28%5Cbeta%29+%26%3D+E_0+-%5Cfrac%7B1%7D%7B%5Cbeta%7D+%5Cln%28N_0%29+%2B+O%5Cleft%28%5Cexp%28-%5Cbeta+%5CDelta_E%29%5Cright%29%2C%5C%5C+E%28%5Cbeta%29+%26%3D+E_0+%2B+O%5Cleft%28%5Cexp%28-%5Cbeta+%5CDelta_E%29%5Cright%29%5C%5C+S%28%5Cbeta%29+%26%3D+%5Cln+N_0+%2B+O%5Cleft%28%5Cexp%28-%5Cbeta+%5CDelta_E%29%5Cright%29.+%5Cend%7Baligned%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\begin{aligned} F(\beta) &amp;= E_0 -\frac{1}{\beta} \ln(N_0) + O\left(\exp(-\beta \Delta_E)\right),\\ E(\beta) &amp;= E_0 + O\left(\exp(-\beta \Delta_E)\right)\\ S(\beta) &amp;= \ln N_0 + O\left(\exp(-\beta \Delta_E)\right). \end{aligned}"/></p>
<p>We can see that the behavior of the system is dominated by the few ground states. As <img alt="\beta \to \infty" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cto+%5Cinfty&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \to \infty"/>, all of the free energy can be attributed to the internal energy term.</p>
<p>On the other hand, as <img alt="\beta \to 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Cto+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \to 0"/>,</p>
<p><img alt="\begin{aligned} F(\beta) &amp;= \mathbb{E}_{x\sim\{\pm 1\}^n} E(x) - \frac{n}{\beta} + O(\beta),\\ U(\beta) &amp;= \mathbb{E}_{x\sim\{\pm 1\}^n} E(x) + O(\beta),\\ S(\beta) &amp;= n + O(\beta), \end{aligned}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D+F%28%5Cbeta%29+%26%3D+%5Cmathbb%7BE%7D_%7Bx%5Csim%5C%7B%5Cpm+1%5C%7D%5En%7D+E%28x%29+-+%5Cfrac%7Bn%7D%7B%5Cbeta%7D+%2B+O%28%5Cbeta%29%2C%5C%5C+U%28%5Cbeta%29+%26%3D+%5Cmathbb%7BE%7D_%7Bx%5Csim%5C%7B%5Cpm+1%5C%7D%5En%7D+E%28x%29+%2B+O%28%5Cbeta%29%2C%5C%5C+S%28%5Cbeta%29+%26%3D+n+%2B+O%28%5Cbeta%29%2C+%5Cend%7Baligned%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\begin{aligned} F(\beta) &amp;= \mathbb{E}_{x\sim\{\pm 1\}^n} E(x) - \frac{n}{\beta} + O(\beta),\\ U(\beta) &amp;= \mathbb{E}_{x\sim\{\pm 1\}^n} E(x) + O(\beta),\\ S(\beta) &amp;= n + O(\beta), \end{aligned}"/></p>
<p>and the behavior of the system is chaotic, with the free energy dominated by the entropy term.</p>
<h3>Phase transition at the critical temperature.</h3>
<p>We say that the system undergoes a <em>phase transition</em> at <img alt="\beta_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta_c"/> if the <em>energy density</em> <img alt="f(\beta) = \lim_{n\to\infty}\frac{1}{n}F(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=f%28%5Cbeta%29+%3D+%5Clim_%7Bn%5Cto%5Cinfty%7D%5Cfrac%7B1%7D%7Bn%7DF%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="f(\beta) = \lim_{n\to\infty}\frac{1}{n}F(\beta)"/> is not analytic at <img alt="\beta = \beta_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+%5Cbeta_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta = \beta_c"/>. Often, this comes from a shift in the relative contributions of the internal energy and entropy terms to <img alt="F(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=F%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="F(\beta)"/>. Phase transitions are often associated as well with a <strong>qualitative</strong> change in system behavior.</p>
<p>For example, we’ll now show that for the Ising model with <img alt="G = K_n" class="latex" src="https://s0.wp.com/latex.php?latex=G+%3D+K_n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="G = K_n"/> the complete graph with self loops, the system has a phase transition at <img alt="\beta_c = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta_c+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta_c = \frac{1}{2}"/> (the self-loops don’t make much physical sense, but are convenient to work with). Furthermore, we’ll show that this phase transition corresponds to a qualitative change in the system, i.e. the loss of magnetism.</p>
<p>Define the <em>magnetization</em> of the system with spins <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> to be <img alt="m(x) = \frac{1}{n}\sum_i x_i" class="latex" src="https://s0.wp.com/latex.php?latex=m%28x%29+%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_i+x_i&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="m(x) = \frac{1}{n}\sum_i x_i"/>. If <img alt="\lim_{n \to \infty} m(x) \not\to 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Clim_%7Bn+%5Cto+%5Cinfty%7D+m%28x%29+%5Cnot%5Cto+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\lim_{n \to \infty} m(x) \not\to 0"/>, then we say the system is <em>magnetized</em>.</p>
<p>In the complete graph, normalized so that the total interaction of each particle is <img alt="1" class="latex" src="https://s0.wp.com/latex.php?latex=1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="1"/>, there is a direct relationship between the energy and the magnetization:</p>
<p><img alt="E(x) = \frac{1}{n}\sum_{i, j} - x_i x_j = - n\cdot m(x)^2." class="latex" src="https://s0.wp.com/latex.php?latex=E%28x%29+%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%2C+j%7D+-+x_i+x_j+%3D+-+n%5Ccdot+m%28x%29%5E2.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="E(x) = \frac{1}{n}\sum_{i, j} - x_i x_j = - n\cdot m(x)^2."/></p>
<h3>Computing the energy density.</h3>
<p>The magnetization takes values <img alt="\frac{k}{n}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7Bk%7D%7Bn%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{k}{n}"/> for <img alt="k\in\{-n,\ldots, n\}" class="latex" src="https://s0.wp.com/latex.php?latex=k%5Cin%5C%7B-n%2C%5Cldots%2C+n%5C%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k\in\{-n,\ldots, n\}"/>. So, letting <img alt="N_k" class="latex" src="https://s0.wp.com/latex.php?latex=N_k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="N_k"/> be the number of states with magnetization <img alt="k/n" class="latex" src="https://s0.wp.com/latex.php?latex=k%2Fn&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k/n"/>, we have that</p>
<p><img alt="Z(\beta) = \sum_{x} \exp(-\beta(- n\cdot m(x)^2)) = \sum_{k = -n}^{n} N_k \cdot \exp\left(\beta n \left(\frac{k}{n}\right)^2\right)." class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cbeta%29+%3D+%5Csum_%7Bx%7D+%5Cexp%28-%5Cbeta%28-+n%5Ccdot+m%28x%29%5E2%29%29+%3D+%5Csum_%7Bk+%3D+-n%7D%5E%7Bn%7D+N_k+%5Ccdot+%5Cexp%5Cleft%28%5Cbeta+n+%5Cleft%28%5Cfrac%7Bk%7D%7Bn%7D%5Cright%29%5E2%5Cright%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\beta) = \sum_{x} \exp(-\beta(- n\cdot m(x)^2)) = \sum_{k = -n}^{n} N_k \cdot \exp\left(\beta n \left(\frac{k}{n}\right)^2\right)."/></p>
<p>Now, <img alt="N_k" class="latex" src="https://s0.wp.com/latex.php?latex=N_k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="N_k"/> is just the number of strings with Hamming weight <img alt="\frac{1}{2}(n+k)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7B1%7D%7B2%7D%28n%2Bk%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{1}{2}(n+k)"/>, so <img alt="N_k = \binom{n}{(n+k)/2}" class="latex" src="https://s0.wp.com/latex.php?latex=N_k+%3D+%5Cbinom%7Bn%7D%7B%28n%2Bk%29%2F2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="N_k = \binom{n}{(n+k)/2}"/>. By Stirling’s approximation <img alt="N_k \approx \exp(n \cdot H(\frac{1+k/n}{2}))" class="latex" src="https://s0.wp.com/latex.php?latex=N_k+%5Capprox+%5Cexp%28n+%5Ccdot+H%28%5Cfrac%7B1%2Bk%2Fn%7D%7B2%7D%29%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="N_k \approx \exp(n \cdot H(\frac{1+k/n}{2}))"/>, where <img alt="H" class="latex" src="https://s0.wp.com/latex.php?latex=H&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="H"/> is the entropy function, so up to lower-order terms</p>
<p><img alt="Z(\beta) \approx \sum_{\substack{k\in [\pm n]\\ k+n \equiv_2 0}} \exp\left( \beta n \left(\frac{k}{n}\right)^2 + H\left(\frac{1 + \frac{k}{n}}{2}\right) n\right)." class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cbeta%29+%5Capprox+%5Csum_%7B%5Csubstack%7Bk%5Cin+%5B%5Cpm+n%5D%5C%5C+k%2Bn+%5Cequiv_2+0%7D%7D+%5Cexp%5Cleft%28+%5Cbeta+n+%5Cleft%28%5Cfrac%7Bk%7D%7Bn%7D%5Cright%29%5E2+%2B+H%5Cleft%28%5Cfrac%7B1+%2B+%5Cfrac%7Bk%7D%7Bn%7D%7D%7B2%7D%5Cright%29+n%5Cright%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\beta) \approx \sum_{\substack{k\in [\pm n]\\ k+n \equiv_2 0}} \exp\left( \beta n \left(\frac{k}{n}\right)^2 + H\left(\frac{1 + \frac{k}{n}}{2}\right) n\right)."/></p>
<p>Now we apply the following simplification: for <img alt="x \in \mathbb{R}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \mathbb{R}^n"/>, <img alt="\|x\|_{\infty} \le \|x\|_1 \le n \|x\|_{\infty}" class="latex" src="https://s0.wp.com/latex.php?latex=%5C%7Cx%5C%7C_%7B%5Cinfty%7D+%5Cle+%5C%7Cx%5C%7C_1+%5Cle+n+%5C%7Cx%5C%7C_%7B%5Cinfty%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\|x\|_{\infty} \le \|x\|_1 \le n \|x\|_{\infty}"/>, and then <img alt="\log(\|x\|_1) = \log \|x\|_{\infty} + O(\log n)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Clog%28%5C%7Cx%5C%7C_1%29+%3D+%5Clog+%5C%7Cx%5C%7C_%7B%5Cinfty%7D+%2B+O%28%5Clog+n%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\log(\|x\|_1) = \log \|x\|_{\infty} + O(\log n)"/>. Treating our summands as the entries of the vector <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/>, from this we have,</p>
<p><img alt="\log(Z(\beta)) = \max_{k \in \{-n,\ldots, n\}} \beta n \left(\frac{k}{n}\right)^2 + H\left(\frac{1}{2}\left(1+\frac{k}{n}\right)\cdot n\right) + O\left(\log n\right)." class="latex" src="https://s0.wp.com/latex.php?latex=%5Clog%28Z%28%5Cbeta%29%29+%3D+%5Cmax_%7Bk+%5Cin+%5C%7B-n%2C%5Cldots%2C+n%5C%7D%7D+%5Cbeta+n+%5Cleft%28%5Cfrac%7Bk%7D%7Bn%7D%5Cright%29%5E2+%2B+H%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cleft%281%2B%5Cfrac%7Bk%7D%7Bn%7D%5Cright%29%5Ccdot+n%5Cright%29+%2B+O%5Cleft%28%5Clog+n%5Cright%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\log(Z(\beta)) = \max_{k \in \{-n,\ldots, n\}} \beta n \left(\frac{k}{n}\right)^2 + H\left(\frac{1}{2}\left(1+\frac{k}{n}\right)\cdot n\right) + O\left(\log n\right)."/></p>
<p>By definition of the energy density,</p>
<p><img alt="f(\beta) = \lim_{n \to \infty} \left(- \frac{1}{\beta n} \log Z(\beta)\right) = -\lim_{n\to\infty} \max_{k \in \{-n,\ldots, n\}} \left(\frac{k}{n}\right)^2 + \frac{1}{\beta}H\left(\frac{1}{2}(1+\frac{k}{n})\right)," class="latex" src="https://s0.wp.com/latex.php?latex=f%28%5Cbeta%29+%3D+%5Clim_%7Bn+%5Cto+%5Cinfty%7D+%5Cleft%28-+%5Cfrac%7B1%7D%7B%5Cbeta+n%7D+%5Clog+Z%28%5Cbeta%29%5Cright%29+%3D+-%5Clim_%7Bn%5Cto%5Cinfty%7D+%5Cmax_%7Bk+%5Cin+%5C%7B-n%2C%5Cldots%2C+n%5C%7D%7D+%5Cleft%28%5Cfrac%7Bk%7D%7Bn%7D%5Cright%29%5E2+%2B+%5Cfrac%7B1%7D%7B%5Cbeta%7DH%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%281%2B%5Cfrac%7Bk%7D%7Bn%7D%29%5Cright%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="f(\beta) = \lim_{n \to \infty} \left(- \frac{1}{\beta n} \log Z(\beta)\right) = -\lim_{n\to\infty} \max_{k \in \{-n,\ldots, n\}} \left(\frac{k}{n}\right)^2 + \frac{1}{\beta}H\left(\frac{1}{2}(1+\frac{k}{n})\right),"/></p>
<p>and since <img alt="n \to \infty" class="latex" src="https://s0.wp.com/latex.php?latex=n+%5Cto+%5Cinfty&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n \to \infty"/> independently of <img alt="\beta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta"/>, we also have</p>
<p><img alt="f(\beta) = -\left(\max_{\delta \in [-1,1]} \delta^2 + \frac{1}{\beta}H\left(\frac{1+\delta}{2}\right)\right)," class="latex" src="https://s0.wp.com/latex.php?latex=f%28%5Cbeta%29+%3D+-%5Cleft%28%5Cmax_%7B%5Cdelta+%5Cin+%5B-1%2C1%5D%7D+%5Cdelta%5E2+%2B+%5Cfrac%7B1%7D%7B%5Cbeta%7DH%5Cleft%28%5Cfrac%7B1%2B%5Cdelta%7D%7B2%7D%5Cright%29%5Cright%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="f(\beta) = -\left(\max_{\delta \in [-1,1]} \delta^2 + \frac{1}{\beta}H\left(\frac{1+\delta}{2}\right)\right),"/></p>
<p>because the error from rounding <img alt="\delta \in [-1,1]" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%5Cin+%5B-1%2C1%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta \in [-1,1]"/> to the nearest factor of <img alt="2/n" class="latex" src="https://s0.wp.com/latex.php?latex=2%2Fn&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="2/n"/> is <img alt="O(1/n)" class="latex" src="https://s0.wp.com/latex.php?latex=O%281%2Fn%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="O(1/n)"/>.</p>
<p>We can see that the first term in the expression for <img alt="f(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=f%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="f(\beta)"/> corresponds to the square of the magnetization (and therefore the energy); the more magnetized the system is, the larger the contribution from the first term. The second term corresponds to the entropy, or the number of configurations in the support; the larger the support, the larger the contribution of the second term. As <img alt="T = \frac{1}{\beta}\to \infty" class="latex" src="https://s0.wp.com/latex.php?latex=T+%3D+%5Cfrac%7B1%7D%7B%5Cbeta%7D%5Cto+%5Cinfty&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T = \frac{1}{\beta}\to \infty"/>, the contribution of the entropy term overwhelms the contribution of the energy term; this is consistent with our physical intuition.</p>
<h3>A phase transition.</h3>
<p>We’ll now demonstrate that there is indeed a phase transition in <img alt="\beta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta"/>. To do so, we solve for this maximum. Taking the derivative with respect to <img alt="\delta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta"/>, we have that</p>
<p><img alt="\frac{\partial}{\partial \delta} \left( \delta^2 + \frac{1}{\beta}H\left(\frac{1+\delta}{2}\right)\right) = 2\delta + \frac{1}{2\beta} \ln \left(\frac{1-\delta}{1+\delta}\right)," class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Cdelta%7D+%5Cleft%28+%5Cdelta%5E2+%2B+%5Cfrac%7B1%7D%7B%5Cbeta%7DH%5Cleft%28%5Cfrac%7B1%2B%5Cdelta%7D%7B2%7D%5Cright%29%5Cright%29+%3D+2%5Cdelta+%2B+%5Cfrac%7B1%7D%7B2%5Cbeta%7D+%5Cln+%5Cleft%28%5Cfrac%7B1-%5Cdelta%7D%7B1%2B%5Cdelta%7D%5Cright%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{\partial}{\partial \delta} \left( \delta^2 + \frac{1}{\beta}H\left(\frac{1+\delta}{2}\right)\right) = 2\delta + \frac{1}{2\beta} \ln \left(\frac{1-\delta}{1+\delta}\right),"/></p>
<p>so the derivative is <img alt="0" class="latex" src="https://s0.wp.com/latex.php?latex=0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="0"/> whenever <img alt="\delta = \frac{1}{4\beta} \ln\left(\frac{1+\delta}{1-\delta}\right)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%3D+%5Cfrac%7B1%7D%7B4%5Cbeta%7D+%5Cln%5Cleft%28%5Cfrac%7B1%2B%5Cdelta%7D%7B1-%5Cdelta%7D%5Cright%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta = \frac{1}{4\beta} \ln\left(\frac{1+\delta}{1-\delta}\right)"/>. From this, we can check the maxima. When <img alt="\beta \textgreater \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Ctextgreater+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \textgreater \frac{1}{2}"/>, there are two maxima equidistant from the origin, corresponding to negatively or positively-magnetized states. When <img alt="\beta \textless \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%5Ctextless+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta \textless \frac{1}{2}"/>, the maximizer is <img alt="0" class="latex" src="https://s0.wp.com/latex.php?latex=0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="0"/>, corresponding to an unmagnetized state.</p>
<p><img alt="exponent" class="alignnone size-full wp-image-6210" src="https://windowsontheory.files.wordpress.com/2018/09/exponent.png?w=600"/></p>
<p>Given the maximizers, we now have the energy density. When we plot the energy density, the phase transition at <img alt="\beta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta = \frac{1}{2}"/> is subtle (an earlier version of this post contained a mistaken plot):</p>

<a href="https://windowsontheory.org/energy-density-2/"><img alt="" class="attachment-thumbnail size-thumbnail" height="100" src="https://windowsontheory.files.wordpress.com/2018/09/energy-density1.png?w=150&amp;h=100" width="150"/></a>
<a href="https://windowsontheory.org/energy-density-zoom-3/"><img alt="" class="attachment-thumbnail size-thumbnail" height="100" src="https://windowsontheory.files.wordpress.com/2018/09/energy-density-zoom2.png?w=150&amp;h=100" width="150"/></a>

<p>But when we plot the derivative, we can see that it is not smooth at <img alt="\beta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta = \frac{1}{2}"/>:</p>

<a href="https://windowsontheory.org/deriv/"><img alt="" class="attachment-thumbnail size-thumbnail" height="100" src="https://windowsontheory.files.wordpress.com/2018/09/deriv.png?w=150&amp;h=100" width="150"/></a>
<a href="https://windowsontheory.org/deriv-zoom/"><img alt="" class="attachment-thumbnail size-thumbnail" height="100" src="https://windowsontheory.files.wordpress.com/2018/09/deriv-zoom.png?w=150&amp;h=100" width="150"/></a>

<p>And with some calculus it is possible to show that the second derivative is indeed not continuous at <img alt="\beta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta = \frac{1}{2}"/>.</p>
<p>Qualitatively, it is convincing that this phase transition in the energy density is related to a transition in the magnetization (because the maximizing <img alt="\delta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta"/> corresponds to the typical magnetization). One can make this formal by performing a similar calculation to show that the internal energy undergoes a phase transition, which in this case is proportional to the expected squared magnetization, <img alt="\mathbb{E}_{P_\beta}[-n \cdot m(x)^2]" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D_%7BP_%5Cbeta%7D%5B-n+%5Ccdot+m%28x%29%5E2%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}_{P_\beta}[-n \cdot m(x)^2]"/>.</p>
<h3>Beyond the complete graph</h3>
<p>The Ising model on the complete graph <img alt="K_n" class="latex" src="https://s0.wp.com/latex.php?latex=K_n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="K_n"/> (also called the Curie-Weiss model) is perhaps not a very convincing model for a physical block of iron; we expect that locality should govern the strength of the interactions. But because the energy and the magnetization are related so simply, it is easy to solve.</p>
<p>Solutions are also known for the 1D and 2D grids; solving it on higher-dimensional lattices, as well as in many other interesting settings, remains open. Interestingly, the <a href="https://en.wikipedia.org/wiki/Conformal_bootstrap">conformal bootstrap method</a> that <a href="https://windowsontheory.org/2018/08/06/physics-envy/">Boaz mentioned</a> has been <a href="https://arxiv.org/abs/1203.6064">used</a> towards solving the Ising model on higher-dimensional grids.</p>
<h2>II. Constraint Satisfaction Problems</h2>
<p>For those familiar with constraint satisfaction problems (CSPs), it may have already been clear that the Ising model is a CSP. The spins <img alt="x \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \{\pm 1\}^n"/> are Boolean variables, and the energy function <img alt="E(x)" class="latex" src="https://s0.wp.com/latex.php?latex=E%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="E(x)"/> is an objective function corresponding to the EQUALITY CSP on <img alt="G" class="latex" src="https://s0.wp.com/latex.php?latex=G&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="G"/> (a pretty boring CSP, when taken without negations). The Boltzmann distribution gives a probability distribution over assignments to the variables <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/>, and the temperature <img alt="T" class="latex" src="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T"/> determines the objective value of a typical <img alt="x \sim P_{\beta}" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Csim+P_%7B%5Cbeta%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \sim P_{\beta}"/>.</p>
<p>We can similarly define the energy, Boltzmann distribution, and free energy/entropy for any CSP (and even to continuous domains such as <img alt="x \in \mathbb{R}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \mathbb{R}^n"/>). Especially popular with statistical physicists are:</p>
<ul>
<li>CSPs (such as the Ising model) over grids and other lattices.</li>
<li>Gaussian spin glasses: CSPs over <img alt="x \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \{\pm 1\}^n"/> or <img alt="x \in \mathbb{R}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5Cmathbb%7BR%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \mathbb{R}^n"/> where the energy function is proportional to <img alt="\langle x^{\otimes k}, J\rangle" class="latex" src="https://s0.wp.com/latex.php?latex=%5Clangle+x%5E%7B%5Cotimes+k%7D%2C+J%5Crangle&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\langle x^{\otimes k}, J\rangle"/>, where <img alt="J" class="latex" src="https://s0.wp.com/latex.php?latex=J&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="J"/> is an order-<img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/> symmetric tensor with entries sampled i.i.d. from <img alt="\mathcal{N}(0,1)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathcal%7BN%7D%280%2C1%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathcal{N}(0,1)"/>. The Ising model on a graph with random Gaussian weights is an example for <img alt="k = 2" class="latex" src="https://s0.wp.com/latex.php?latex=k+%3D+2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k = 2"/>.</li>
<li>Random instances of <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT: Of the <img alt="\binom{n}{k} \cdot 2^k" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbinom%7Bn%7D%7Bk%7D+%5Ccdot+2%5Ek&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\binom{n}{k} \cdot 2^k"/> possible clauses (with negations) on <img alt="n" class="latex" src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n"/> variables, <img alt="m" class="latex" src="https://s0.wp.com/latex.php?latex=m&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="m"/> clauses <img alt="C_1,\ldots,C_m" class="latex" src="https://s0.wp.com/latex.php?latex=C_1%2C%5Cldots%2CC_m&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C_1,\ldots,C_m"/> are sampled uniformly at random, and the energy function is the number of satisfied clauses, <img alt="E(x) = |\{ i \in [m] : C_i(x) = 1\}|" class="latex" src="https://s0.wp.com/latex.php?latex=E%28x%29+%3D+%7C%5C%7B+i+%5Cin+%5Bm%5D+%3A+C_i%28x%29+%3D+1%5C%7D%7C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="E(x) = |\{ i \in [m] : C_i(x) = 1\}|"/>.</li>
<li>Random instances of other Boolean and larger-alphabet CSPs.</li>
</ul>
<p>In some cases, these CSPs are reasonable models for physical systems; in<br/>
other cases, they are primarily of theoretical interest.</p>
<h3>Algorithmic questions</h3>
<p>As theoretical computer scientists, we are used to seeing CSPs in the contex of optimization. In statistical physics, the goal is to understand the qualitative behavior of the system as described by the Boltzmann distribution. They ask algorithmic questions such as:</p>
<ul>
<li>Can we estimate the free energy <img alt="F(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=F%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="F(\beta)"/>? The partition function <img alt="Z(\beta)" class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cbeta%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\beta)"/>? And, relatedly,</li>
<li>Can we sample from <img alt="P_{\beta}" class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}"/>?</li>
</ul>
<p>But these tasks are not so different from optimization. For example, if our system is an instance of 3SAT, when <img alt="T=0" class="latex" src="https://s0.wp.com/latex.php?latex=T%3D0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T=0"/>, the Boltzmann distribution is the uniform distribution over maximally satisfying assignments, and so estimating <img alt="Z(\infty)" class="latex" src="https://s0.wp.com/latex.php?latex=Z%28%5Cinfty%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z(\infty)"/> is equivalent to deciding the SAT formula, and sampling from <img alt="P_{\infty}" class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cinfty%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\infty}"/> is equivalent to solving the SAT formula. As <img alt="T" class="latex" src="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T"/> increases, sampling from <img alt="P_{\beta}" class="latex" src="https://s0.wp.com/latex.php?latex=P_%7B%5Cbeta%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="P_{\beta}"/> corresponds to sampling an approximate solution.</p>
<p>Clearly in the worst case, these tasks are NP-Hard (and even #P-hard). But even for random instances these algorithmic questions are interesting.</p>
<h3>Phase transitions in satisfiability</h3>
<p>In random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT, the system is controlled not only by the temperature <img alt="T" class="latex" src="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T"/> but also by the <em>clause density</em> <img alt="\alpha = \frac{m}{n}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+%5Cfrac%7Bm%7D%7Bn%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha = \frac{m}{n}"/>. For the remainder of the post, we will focus on the zero-temperature regime <img alt="T = 0" class="latex" src="https://s0.wp.com/latex.php?latex=T+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="T = 0"/>, and we will see that <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT exhibits phase transitions in <img alt="\alpha" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha"/> as well.</p>
<p>The most natural “physical” trait to track in a <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT formula is whether or not it is <em>satisfiable</em>. When <img alt="\alpha = 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha = 0"/>, <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT instances are clearly satisfiable, because they have no constraints. Similarly when <img alt="\alpha = n^k \cdot 2^k" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+n%5Ek+%5Ccdot+2%5Ek&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha = n^k \cdot 2^k"/>, random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT instances cannot be satisfiable, because for any set of <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/> variables they will contain all <img alt="2^k" class="latex" src="https://s0.wp.com/latex.php?latex=2%5Ek&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="2^k"/> possible <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT constraints (clearly unsatisfiable). It is natural to ask: is there a satisfiability phase transition in <img alt="\alpha" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha"/>?</p>
<p>For <img alt="k = 2" class="latex" src="https://s0.wp.com/latex.php?latex=k+%3D+2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k = 2"/>, one can show that the answer is yes. For <img alt="k \ge 3" class="latex" src="https://s0.wp.com/latex.php?latex=k+%5Cge+3&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k \ge 3"/>, numerical evidence strongly points to this being the case; further, the following theorem of Friedgut gives a partial answer:</p>
<p><strong>Theorem:</strong><br/>
For there exists a function <img alt="\alpha_c(n)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c%28n%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c(n)"/> such that for any <img alt="\epsilon \textgreater 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cepsilon+%5Ctextgreater+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\epsilon \textgreater 0"/>, if <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/> is a random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT formula on <img alt="n" class="latex" src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n"/> variables with <img alt="\alpha n" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha n"/> clauses, then</p>
<p><img alt="\lim_{n \to \infty} \Pr[\phi \text{ is satisfiable}] = \begin{cases} 1 &amp; \text{ if } \alpha \textless (1-\epsilon) \alpha_c(n)\\ 0 &amp; \text{ if } \alpha \textgreater (1+\epsilon) \alpha_c(n) \end{cases}." class="latex" src="https://s0.wp.com/latex.php?latex=%5Clim_%7Bn+%5Cto+%5Cinfty%7D+%5CPr%5B%5Cphi+%5Ctext%7B+is+satisfiable%7D%5D+%3D+%5Cbegin%7Bcases%7D+1+%26+%5Ctext%7B+if+%7D+%5Calpha+%5Ctextless+%281-%5Cepsilon%29+%5Calpha_c%28n%29%5C%5C+0+%26+%5Ctext%7B+if+%7D+%5Calpha+%5Ctextgreater+%281%2B%5Cepsilon%29+%5Calpha_c%28n%29+%5Cend%7Bcases%7D.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\lim_{n \to \infty} \Pr[\phi \text{ is satisfiable}] = \begin{cases} 1 &amp; \text{ if } \alpha \textless (1-\epsilon) \alpha_c(n)\\ 0 &amp; \text{ if } \alpha \textgreater (1+\epsilon) \alpha_c(n) \end{cases}."/></p>
<p> </p>
<p>However, this theorem allows for the possibility that the threshold depends on <img alt="n" class="latex" src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n"/>. From a statistical physics standpoint, this would be ridiculous, as it suggests that the behavior of the system depends on the number of particles that participate in it. We state the commonly held stronger conjecture:</p>
<p><strong>Conjecture:</strong><br/>
for all <img alt="k \ge 3" class="latex" src="https://s0.wp.com/latex.php?latex=k+%5Cge+3&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k \ge 3"/>, there exists a constant <img alt="\alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c"/> depending only on <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/> such that if <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/> is a random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT instance in <img alt="n" class="latex" src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n"/> variables and <img alt="\alpha n" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha n"/> clauses, then</p>
<p><img alt="\lim_{n \to \infty} \Pr[\phi \text{ is satisfiable}] = \begin{cases} 1 &amp; \text{ if } \alpha \textless \alpha_c \\ 1 &amp; \text{ if } \alpha \textgreater \alpha_c \end{cases}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Clim_%7Bn+%5Cto+%5Cinfty%7D+%5CPr%5B%5Cphi+%5Ctext%7B+is+satisfiable%7D%5D+%3D+%5Cbegin%7Bcases%7D+1+%26+%5Ctext%7B+if+%7D+%5Calpha+%5Ctextless+%5Calpha_c+%5C%5C+1+%26+%5Ctext%7B+if+%7D+%5Calpha+%5Ctextgreater+%5Calpha_c+%5Cend%7Bcases%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\lim_{n \to \infty} \Pr[\phi \text{ is satisfiable}] = \begin{cases} 1 &amp; \text{ if } \alpha \textless \alpha_c \\ 1 &amp; \text{ if } \alpha \textgreater \alpha_c \end{cases}"/></p>
<p> </p>
<p>In 2015, Jian Ding, Allan Sly, and Nike Sun established the <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT conjecture all <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/> larger than some fixed constant <img alt="k_0" class="latex" src="https://s0.wp.com/latex.php?latex=k_0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k_0"/>, and we will be hearing about the proof from Nike later on in the course.</p>
<h3>Bounds on <img alt="\alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c"/> via the method of moments</h3>
<p>Let us move to a simpler model of random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT formulas, which is a bit easier to work with and is a close approximation to our original model. Instead of sampling <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT clauses without replacement, we will sample them with replacement and also allow variables to appear multiple times in the same clause (so each literal is chosen uniformly at random). The independence of the clauses makes computations in this model simpler.</p>
<p>We’ll prove the following bounds. The upper bound is a fairly straightforward computation, and the lower bound is given by an elegant argument due to Achlioptas and Peres.</p>
<p><strong>Theorem:</strong><br/>
For every <img alt="k \ge 3" class="latex" src="https://s0.wp.com/latex.php?latex=k+%5Cge+3&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k \ge 3"/>, <img alt="2^k \ln 2 - O(k) \le \alpha_c \le 2^k \ln 2 - O(1)" class="latex" src="https://s0.wp.com/latex.php?latex=2%5Ek+%5Cln+2+-+O%28k%29+%5Cle+%5Calpha_c+%5Cle+2%5Ek+%5Cln+2+-+O%281%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="2^k \ln 2 - O(k) \le \alpha_c \le 2^k \ln 2 - O(1)"/>.</p>
<p>Let <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/> be a random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT formula with <img alt="m = \alpha n" class="latex" src="https://s0.wp.com/latex.php?latex=m+%3D+%5Calpha+n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="m = \alpha n"/> clauses, <img alt="C_1,\ldots,C_m" class="latex" src="https://s0.wp.com/latex.php?latex=C_1%2C%5Cldots%2CC_m&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C_1,\ldots,C_m"/>. For an assignment <img alt="x \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \{\pm 1\}^n"/>, let <img alt="\phi(x)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi(x)"/> be the <img alt="0/1" class="latex" src="https://s0.wp.com/latex.php?latex=0%2F1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="0/1"/> indicator that <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> satisfies <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/>. Finally, let <img alt="Z_{\alpha} = \sum_x \phi(x)" class="latex" src="https://s0.wp.com/latex.php?latex=Z_%7B%5Calpha%7D+%3D+%5Csum_x+%5Cphi%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z_{\alpha} = \sum_x \phi(x)"/> be the number of satisfying assignments of <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/>.</p>
<h4>Upper bound via the first moment method.</h4>
<p>We have by Markov’s inequality that</p>
<p><img alt="\Pr[Z_{\alpha} \ge 1] \le \mathbb{E}[Z_{\alpha}] = \sum_{x} \Pr[\phi(x)]." class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5BZ_%7B%5Calpha%7D+%5Cge+1%5D+%5Cle+%5Cmathbb%7BE%7D%5BZ_%7B%5Calpha%7D%5D+%3D+%5Csum_%7Bx%7D+%5CPr%5B%5Cphi%28x%29%5D.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr[Z_{\alpha} \ge 1] \le \mathbb{E}[Z_{\alpha}] = \sum_{x} \Pr[\phi(x)]."/></p>
<p>Fix an assignment <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/>. Then by the independence of the clauses,</p>
<p><img alt="\Pr[\phi(x)] = \prod_{j \in [m]} \Pr[C_j(x) = 1] = \left(1 - \frac{1}{2^k}\right)^m," class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5B%5Cphi%28x%29%5D+%3D+%5Cprod_%7Bj+%5Cin+%5Bm%5D%7D+%5CPr%5BC_j%28x%29+%3D+1%5D+%3D+%5Cleft%281+-+%5Cfrac%7B1%7D%7B2%5Ek%7D%5Cright%29%5Em%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr[\phi(x)] = \prod_{j \in [m]} \Pr[C_j(x) = 1] = \left(1 - \frac{1}{2^k}\right)^m,"/></p>
<p>since each clause has <img alt="2^k -1" class="latex" src="https://s0.wp.com/latex.php?latex=2%5Ek+-1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="2^k -1"/> satisfying assignments. Summing over all<br/>
<img alt="x \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x \in \{\pm 1\}^n"/>,</p>
<p><img alt="\mathbb{E}[Z_{\alpha}] = 2^n \left(1 - \frac{1}{2^k}\right)^{\alpha n}." class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BZ_%7B%5Calpha%7D%5D+%3D+2%5En+%5Cleft%281+-+%5Cfrac%7B1%7D%7B2%5Ek%7D%5Cright%29%5E%7B%5Calpha+n%7D.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[Z_{\alpha}] = 2^n \left(1 - \frac{1}{2^k}\right)^{\alpha n}."/></p>
<p>We can see that if <img alt="\alpha \textgreater 2^k \ln 2" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Ctextgreater+2%5Ek+%5Cln+2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha \textgreater 2^k \ln 2"/>, this quantity will go to <img alt="0" class="latex" src="https://s0.wp.com/latex.php?latex=0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="0"/> with <img alt="n" class="latex" src="https://s0.wp.com/latex.php?latex=n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n"/>. So we have:</p>
<p><img alt="\alpha_c \le 2^k \ln 2." class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c+%5Cle+2%5Ek+%5Cln+2.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c \le 2^k \ln 2."/></p>
<h4>Lower bound via the second moment method.</h4>
<p>To lower bound <img alt="\alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c"/>, we can use the <em>second moment method</em>. We’ll<br/>
calculate the second moment of <img alt="Z_{\alpha}" class="latex" src="https://s0.wp.com/latex.php?latex=Z_%7B%5Calpha%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z_{\alpha}"/>. An easy use of Cauchy-Schwarz (for non-negative <img alt="X" class="latex" src="https://s0.wp.com/latex.php?latex=X&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="X"/>, <img alt="\mathbb{E}[X] \le \sqrt{\mathbb{E}[X^2]\mathbb{E}[I[X \textgreater 0]]}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BX%5D+%5Cle+%5Csqrt%7B%5Cmathbb%7BE%7D%5BX%5E2%5D%5Cmathbb%7BE%7D%5BI%5BX+%5Ctextgreater+0%5D%5D%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[X] \le \sqrt{\mathbb{E}[X^2]\mathbb{E}[I[X \textgreater 0]]}"/>) implies that if there is a constant <img alt="c" class="latex" src="https://s0.wp.com/latex.php?latex=c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="c"/> such that</p>
<p><img alt="\lim_{n \to \infty}\frac{\left(\mathbb{E} Z_{\alpha}\right)^2}{\mathbb{E}Z_{\alpha}^2} \ge c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Clim_%7Bn+%5Cto+%5Cinfty%7D%5Cfrac%7B%5Cleft%28%5Cmathbb%7BE%7D+Z_%7B%5Calpha%7D%5Cright%29%5E2%7D%7B%5Cmathbb%7BE%7DZ_%7B%5Calpha%7D%5E2%7D+%5Cge+c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\lim_{n \to \infty}\frac{\left(\mathbb{E} Z_{\alpha}\right)^2}{\mathbb{E}Z_{\alpha}^2} \ge c"/>,</p>
<p>then with at least constant probability <img alt="Z_{\alpha} \ge 1" class="latex" src="https://s0.wp.com/latex.php?latex=Z_%7B%5Calpha%7D+%5Cge+1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z_{\alpha} \ge 1"/>, and then Friedgut’s theorem implies that <img alt="\alpha \textless \alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Ctextless+%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha \textless \alpha_c"/>. From above we have an expression for the numerator, so we now set out to bound the second moment of <img alt="Z_{\alpha}" class="latex" src="https://s0.wp.com/latex.php?latex=Z_%7B%5Calpha%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z_{\alpha}"/>. We have that</p>
<p><img alt="\mathbb{E} Z_{\alpha}^2 = \mathbb{E}\left[\left(\sum_{x}I[\phi(x)]\right)^2\right] = \sum_{x,y} \Pr\left[\phi(x)\wedge \phi(y)\right]," class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D+Z_%7B%5Calpha%7D%5E2+%3D+%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%28%5Csum_%7Bx%7DI%5B%5Cphi%28x%29%5D%5Cright%29%5E2%5Cright%5D+%3D+%5Csum_%7Bx%2Cy%7D+%5CPr%5Cleft%5B%5Cphi%28x%29%5Cwedge+%5Cphi%28y%29%5Cright%5D%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E} Z_{\alpha}^2 = \mathbb{E}\left[\left(\sum_{x}I[\phi(x)]\right)^2\right] = \sum_{x,y} \Pr\left[\phi(x)\wedge \phi(y)\right],"/></p>
<p>and by the independence of the clauses,</p>
<p><img alt="\Pr\left[\phi(x)\wedge \phi(y)\right] = \prod_{j \in [m]} \Pr[C_j(x) = 1 \wedge C_j(y) = 1] = \left(\Pr[C(x) = 1 \wedge C(y) = 1]\right)^m," class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5Cleft%5B%5Cphi%28x%29%5Cwedge+%5Cphi%28y%29%5Cright%5D+%3D+%5Cprod_%7Bj+%5Cin+%5Bm%5D%7D+%5CPr%5BC_j%28x%29+%3D+1+%5Cwedge+C_j%28y%29+%3D+1%5D+%3D+%5Cleft%28%5CPr%5BC%28x%29+%3D+1+%5Cwedge+C%28y%29+%3D+1%5D%5Cright%29%5Em%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr\left[\phi(x)\wedge \phi(y)\right] = \prod_{j \in [m]} \Pr[C_j(x) = 1 \wedge C_j(y) = 1] = \left(\Pr[C(x) = 1 \wedge C(y) = 1]\right)^m,"/></p>
<p>for a single random <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT clause <img alt="C" class="latex" src="https://s0.wp.com/latex.php?latex=C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C"/>. But, for <img alt="x,y \in \{\pm 1\}^n" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy+%5Cin+%5C%7B%5Cpm+1%5C%7D%5En&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y \in \{\pm 1\}^n"/>, the events <img alt="C(x) = 1" class="latex" src="https://s0.wp.com/latex.php?latex=C%28x%29+%3D+1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C(x) = 1"/> and <img alt="C(y)=1" class="latex" src="https://s0.wp.com/latex.php?latex=C%28y%29%3D1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C(y)=1"/> are not independent. This is easier to see if we apply inclusion-exclusion,</p>
<p><img alt="\Pr[C(x) = 1 \wedge C(y) = 1] = 1 - \Pr[C(x) = 0] - \Pr[C(y) = 0] + \Pr[C(x) = C(y) = 0]," class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5BC%28x%29+%3D+1+%5Cwedge+C%28y%29+%3D+1%5D+%3D+1+-+%5CPr%5BC%28x%29+%3D+0%5D+-+%5CPr%5BC%28y%29+%3D+0%5D+%2B+%5CPr%5BC%28x%29+%3D+C%28y%29+%3D+0%5D%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr[C(x) = 1 \wedge C(y) = 1] = 1 - \Pr[C(x) = 0] - \Pr[C(y) = 0] + \Pr[C(x) = C(y) = 0],"/></p>
<p>The event that both <img alt="C(x) = C(y) = 0" class="latex" src="https://s0.wp.com/latex.php?latex=C%28x%29+%3D+C%28y%29+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C(x) = C(y) = 0"/> when <img alt="C" class="latex" src="https://s0.wp.com/latex.php?latex=C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C"/> is a <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT clause occurs only when <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> and <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/> agree exactly on the assignments to the variables of <img alt="C" class="latex" src="https://s0.wp.com/latex.php?latex=C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C"/>, since otherwise at least one of <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> or <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/> must be satisfied (because each literal in <img alt="C(x)" class="latex" src="https://s0.wp.com/latex.php?latex=C%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C(x)"/> is negated for <img alt="C(y)" class="latex" src="https://s0.wp.com/latex.php?latex=C%28y%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C(y)"/>). Thus, this probability depends on the Hamming distance between <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> and <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/>.</p>
<p><img alt="agreement" class="alignnone wp-image-6205" src="https://windowsontheory.files.wordpress.com/2018/09/agreement.png?w=300" width="300"/></p>
<p>For <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> with <img alt="\frac{1}{2}\|x-y\|_1 = (1-\delta)n" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7B1%7D%7B2%7D%5C%7Cx-y%5C%7C_1+%3D+%281-%5Cdelta%29n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{1}{2}\|x-y\|_1 = (1-\delta)n"/>, the probability that <img alt="C" class="latex" src="https://s0.wp.com/latex.php?latex=C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C"/>‘s variables are all in the subset on which <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> agree is <img alt="\delta^k" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta%5Ek&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta^k"/> (up to lower order terms). So, we have</p>
<p><img alt="\Pr[C(x) = C(y) = 0] = \delta^k \cdot \frac{1}{2^k}," class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5BC%28x%29+%3D+C%28y%29+%3D+0%5D+%3D+%5Cdelta%5Ek+%5Ccdot+%5Cfrac%7B1%7D%7B2%5Ek%7D%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr[C(x) = C(y) = 0] = \delta^k \cdot \frac{1}{2^k},"/></p>
<p>and then for <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> with <img alt="\frac{1}{2}\|x-y\|_1 = n - \ell" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7B1%7D%7B2%7D%5C%7Cx-y%5C%7C_1+%3D+n+-+%5Cell&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{1}{2}\|x-y\|_1 = n - \ell"/>,</p>
<p><img alt="\Pr[C(x) = 1 \wedge C(y) = 1] = 1 - 2\cdot \frac{1}{2^k} + \left(\frac{\ell}{2n}\right)^k." class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5BC%28x%29+%3D+1+%5Cwedge+C%28y%29+%3D+1%5D+%3D+1+-+2%5Ccdot+%5Cfrac%7B1%7D%7B2%5Ek%7D+%2B+%5Cleft%28%5Cfrac%7B%5Cell%7D%7B2n%7D%5Cright%29%5Ek.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr[C(x) = 1 \wedge C(y) = 1] = 1 - 2\cdot \frac{1}{2^k} + \left(\frac{\ell}{2n}\right)^k."/></p>
<p>Because there are <img alt="2^n \cdot \binom{n}{\ell}" class="latex" src="https://s0.wp.com/latex.php?latex=2%5En+%5Ccdot+%5Cbinom%7Bn%7D%7B%5Cell%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="2^n \cdot \binom{n}{\ell}"/> pairs <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> at distance <img alt="\frac{1}{2}\|x-y\|_1 = n - \ell" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7B1%7D%7B2%7D%5C%7Cx-y%5C%7C_1+%3D+n+-+%5Cell&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{1}{2}\|x-y\|_1 = n - \ell"/>,</p>
<p><img alt="\mathbb{E}\left[Z_{\alpha}^2\right] = \sum_{\ell = 0}^{n} 2^n \cdot \binom{n}{\ell} \cdot \left(1 - \frac{1}{2^{k-1}} + \left(\frac{\ell}{2n}\right)^k\right)^m," class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5Cleft%5BZ_%7B%5Calpha%7D%5E2%5Cright%5D+%3D+%5Csum_%7B%5Cell+%3D+0%7D%5E%7Bn%7D+2%5En+%5Ccdot+%5Cbinom%7Bn%7D%7B%5Cell%7D+%5Ccdot+%5Cleft%281+-+%5Cfrac%7B1%7D%7B2%5E%7Bk-1%7D%7D+%2B+%5Cleft%28%5Cfrac%7B%5Cell%7D%7B2n%7D%5Cright%29%5Ek%5Cright%29%5Em%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}\left[Z_{\alpha}^2\right] = \sum_{\ell = 0}^{n} 2^n \cdot \binom{n}{\ell} \cdot \left(1 - \frac{1}{2^{k-1}} + \left(\frac{\ell}{2n}\right)^k\right)^m,"/></p>
<p>and using the Stirling bound <img alt="\binom{n}{\ell} \le O(\frac{1}{\sqrt{n}})\exp(n \cdot H(\ell/n))" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbinom%7Bn%7D%7B%5Cell%7D+%5Cle+O%28%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%7D%7D%29%5Cexp%28n+%5Ccdot+H%28%5Cell%2Fn%29%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\binom{n}{\ell} \le O(\frac{1}{\sqrt{n}})\exp(n \cdot H(\ell/n))"/>,</p>
<p><img alt="= \sum_{\ell = 0}^{n}O(\frac{1}{\sqrt{n}}) \exp\left( \left(H\left(\frac{\ell}{n}\right) + \ln 2\right)\cdot n + \ln\left(1 - \frac{1}{2^{k-1}} + \left(\frac{\ell}{2n}\right)^k\right) \cdot \alpha n\right)." class="latex" src="https://s0.wp.com/latex.php?latex=%3D+%5Csum_%7B%5Cell+%3D+0%7D%5E%7Bn%7DO%28%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%7D%7D%29+%5Cexp%5Cleft%28+%5Cleft%28H%5Cleft%28%5Cfrac%7B%5Cell%7D%7Bn%7D%5Cright%29+%2B+%5Cln+2%5Cright%29%5Ccdot+n+%2B+%5Cln%5Cleft%281+-+%5Cfrac%7B1%7D%7B2%5E%7Bk-1%7D%7D+%2B+%5Cleft%28%5Cfrac%7B%5Cell%7D%7B2n%7D%5Cright%29%5Ek%5Cright%29+%5Ccdot+%5Calpha+n%5Cright%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="= \sum_{\ell = 0}^{n}O(\frac{1}{\sqrt{n}}) \exp\left( \left(H\left(\frac{\ell}{n}\right) + \ln 2\right)\cdot n + \ln\left(1 - \frac{1}{2^{k-1}} + \left(\frac{\ell}{2n}\right)^k\right) \cdot \alpha n\right)."/></p>
<p>Using Laplace’s method, we can show that this sum will be dominated by the <img alt="O(\sqrt{n})" class="latex" src="https://s0.wp.com/latex.php?latex=O%28%5Csqrt%7Bn%7D%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="O(\sqrt{n})"/> terms around the maximizing summand; so defining <img alt="\psi(\delta) = H(\delta) + \ln 2 + \alpha\ln (1 - 2^{-k+1} + \delta^k 2^{-k}))" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cpsi%28%5Cdelta%29+%3D+H%28%5Cdelta%29+%2B+%5Cln+2+%2B+%5Calpha%5Cln+%281+-+2%5E%7B-k%2B1%7D+%2B+%5Cdelta%5Ek+2%5E%7B-k%7D%29%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\psi(\delta) = H(\delta) + \ln 2 + \alpha\ln (1 - 2^{-k+1} + \delta^k 2^{-k}))"/>,</p>
<p><img alt="\mathbb{E}[Z_{\alpha}^2] = O(1) \cdot \exp( n \cdot \max_{\delta \in [0,1]} \psi(\delta))." class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BZ_%7B%5Calpha%7D%5E2%5D+%3D+O%281%29+%5Ccdot+%5Cexp%28+n+%5Ccdot+%5Cmax_%7B%5Cdelta+%5Cin+%5B0%2C1%5D%7D+%5Cpsi%28%5Cdelta%29%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[Z_{\alpha}^2] = O(1) \cdot \exp( n \cdot \max_{\delta \in [0,1]} \psi(\delta))."/></p>
<p>If we want that <img alt="\mathbb{E}[Z^2] \le c \cdot \mathbb{E}[Z]^2" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BZ%5E2%5D+%5Cle+c+%5Ccdot+%5Cmathbb%7BE%7D%5BZ%5D%5E2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[Z^2] \le c \cdot \mathbb{E}[Z]^2"/>, then we require that</p>
<p><img alt="\max_{\delta \in [0,1]} \psi(\delta) \le \frac{1}{n}\ln(\mathbb{E}[Z]^2) = 2\ln 2 + 2\alpha \ln (1-2^{-k})." class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmax_%7B%5Cdelta+%5Cin+%5B0%2C1%5D%7D+%5Cpsi%28%5Cdelta%29+%5Cle+%5Cfrac%7B1%7D%7Bn%7D%5Cln%28%5Cmathbb%7BE%7D%5BZ%5D%5E2%29+%3D+2%5Cln+2+%2B+2%5Calpha+%5Cln+%281-2%5E%7B-k%7D%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\max_{\delta \in [0,1]} \psi(\delta) \le \frac{1}{n}\ln(\mathbb{E}[Z]^2) = 2\ln 2 + 2\alpha \ln (1-2^{-k})."/></p>
<p>However, we can see (using calculus) that this inequality does not hold whenever <img alt="\alpha \textgreater 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Ctextgreater+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha \textgreater 0"/>. In the plot below one can also see this, though the values are very close when <img alt="\alpha" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha"/> is close to <img alt="0" class="latex" src="https://s0.wp.com/latex.php?latex=0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="0"/>:</p>
<p> </p>

<a href="https://windowsontheory.org/2018/09/15/statistical-physics-an-introduction-in-two-parts/sat-second-moment-3/"><img alt="" class="attachment-thumbnail size-thumbnail" height="100" src="https://windowsontheory.files.wordpress.com/2018/09/sat-second-moment2.png?w=150&amp;h=100" width="150"/></a>
<a href="https://windowsontheory.org/2018/09/15/statistical-physics-an-introduction-in-two-parts/sat-second-moment-zoom-2/"><img alt="" class="attachment-thumbnail size-thumbnail" height="100" src="https://windowsontheory.files.wordpress.com/2018/09/sat-second-moment-zoom1.png?w=150&amp;h=100" width="150"/></a>

<p>So the naive second moment method fails to establish any lower bound on <img alt="\alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c"/>. The problem here is that the second moment is dominated by the large correlations of close strings; whenever <img alt="\alpha \textgreater 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Ctextgreater+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha \textgreater 0"/>, the sum is dominated by pairs of strings <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> which are closer than <img alt="n/2" class="latex" src="https://s0.wp.com/latex.php?latex=n%2F2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n/2"/> in Hamming distance, which is atypical. For strings at Hamming distance <img alt="n/2" class="latex" src="https://s0.wp.com/latex.php?latex=n%2F2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n/2"/>, what is relevant is <img alt="\psi(\frac{1}{2})" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cpsi%28%5Cfrac%7B1%7D%7B2%7D%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\psi(\frac{1}{2})"/>, which is always</p>
<p><img alt="\psi(\frac{1}{2}) = H(\frac{1}{2}) + \ln 2 + \alpha \ln \left(1 - \frac{1}{2^{k-1}} + \frac{1}{2^{2k}}\right) = 2\ln 2 + \alpha \ln \left(1 - \frac{1}{2^k}\right)^{2}," class="latex" src="https://s0.wp.com/latex.php?latex=%5Cpsi%28%5Cfrac%7B1%7D%7B2%7D%29+%3D+H%28%5Cfrac%7B1%7D%7B2%7D%29+%2B+%5Cln+2+%2B+%5Calpha+%5Cln+%5Cleft%281+-+%5Cfrac%7B1%7D%7B2%5E%7Bk-1%7D%7D+%2B+%5Cfrac%7B1%7D%7B2%5E%7B2k%7D%7D%5Cright%29+%3D+2%5Cln+2+%2B+%5Calpha+%5Cln+%5Cleft%281+-+%5Cfrac%7B1%7D%7B2%5Ek%7D%5Cright%29%5E%7B2%7D%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\psi(\frac{1}{2}) = H(\frac{1}{2}) + \ln 2 + \alpha \ln \left(1 - \frac{1}{2^{k-1}} + \frac{1}{2^{2k}}\right) = 2\ln 2 + \alpha \ln \left(1 - \frac{1}{2^k}\right)^{2},"/></p>
<p>which is equal to <img alt="\frac{1}{n}\ln\mathbb{E}[Z_{\alpha}]^2" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cfrac%7B1%7D%7Bn%7D%5Cln%5Cmathbb%7BE%7D%5BZ_%7B%5Calpha%7D%5D%5E2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\frac{1}{n}\ln\mathbb{E}[Z_{\alpha}]^2"/>. At distance <img alt="n/2" class="latex" src="https://s0.wp.com/latex.php?latex=n%2F2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n/2"/>, the value of <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/> on pairs <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> is essentially uncorrelated (one can think of drawing a uniformly random <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/> given <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/>), so such pairs are representative of <img alt="\mathbb{E}[Z]^2" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BZ%5D%5E2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[Z]^2"/>.</p>
<h4>A more delicate approach.</h4>
<p>To get a good bound, we have to perform a fancier second moment method calculation, due to Achlioptas and Peres. We will re-weight the terms so that more typical pairs, at distance <img alt="n/2" class="latex" src="https://s0.wp.com/latex.php?latex=n%2F2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="n/2"/>, are dominant. Rather than computing <img alt="Z_{\alpha}" class="latex" src="https://s0.wp.com/latex.php?latex=Z_%7B%5Calpha%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="Z_{\alpha}"/>, we compute <img alt="X_{\alpha}" class="latex" src="https://s0.wp.com/latex.php?latex=X_%7B%5Calpha%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="X_{\alpha}"/>, where</p>
<p><img alt="X_{\alpha} = \sum_{x} \prod_{j \in [m]} w_j(x)," class="latex" src="https://s0.wp.com/latex.php?latex=X_%7B%5Calpha%7D+%3D+%5Csum_%7Bx%7D+%5Cprod_%7Bj+%5Cin+%5Bm%5D%7D+w_j%28x%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="X_{\alpha} = \sum_{x} \prod_{j \in [m]} w_j(x),"/></p>
<p>where <img alt="w_j(x) = 0" class="latex" src="https://s0.wp.com/latex.php?latex=w_j%28x%29+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j(x) = 0"/> if <img alt="C_j(x) = 0" class="latex" src="https://s0.wp.com/latex.php?latex=C_j%28x%29+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C_j(x) = 0"/>, and <img alt="w_j(x) = \eta^t" class="latex" src="https://s0.wp.com/latex.php?latex=w_j%28x%29+%3D+%5Ceta%5Et&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j(x) = \eta^t"/> if <img alt="C_j(x)" class="latex" src="https://s0.wp.com/latex.php?latex=C_j%28x%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="C_j(x)"/> is satisfied by <img alt="t" class="latex" src="https://s0.wp.com/latex.php?latex=t&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="t"/> variables. Since <img alt="X_{\alpha} \textgreater 0" class="latex" src="https://s0.wp.com/latex.php?latex=X_%7B%5Calpha%7D+%5Ctextgreater+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="X_{\alpha} \textgreater 0"/> only if <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/> has satisfying assignments, the goal is to still bound <img alt="\mathbb{E}[X_{\alpha}^2] \le c\cdot \mathbb{E}[X_{\alpha}]^2" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BX_%7B%5Calpha%7D%5E2%5D+%5Cle+c%5Ccdot+%5Cmathbb%7BE%7D%5BX_%7B%5Calpha%7D%5D%5E2&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[X_{\alpha}^2] \le c\cdot \mathbb{E}[X_{\alpha}]^2"/>. Again using the independence of the clauses, we have that</p>
<p><img alt="\begin{aligned} \mathbb{E}[X_{\alpha}] = 2^n \cdot \mathbb{E}[w_j(x)]^m = 2^n \left(2^{-k}\sum_{t = 1}^k \binom{k}{t} \eta^t \right)^m = 2^n \left(\left(\frac{1+\eta}{2}\right)^k-2^{-k}\right)^m.\label{eq:expect}\end{aligned}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D+%5Cmathbb%7BE%7D%5BX_%7B%5Calpha%7D%5D+%3D+2%5En+%5Ccdot+%5Cmathbb%7BE%7D%5Bw_j%28x%29%5D%5Em+%3D+2%5En+%5Cleft%282%5E%7B-k%7D%5Csum_%7Bt+%3D+1%7D%5Ek+%5Cbinom%7Bk%7D%7Bt%7D+%5Ceta%5Et+%5Cright%29%5Em+%3D+2%5En+%5Cleft%28%5Cleft%28%5Cfrac%7B1%2B%5Ceta%7D%7B2%7D%5Cright%29%5Ek-2%5E%7B-k%7D%5Cright%29%5Em.%5Clabel%7Beq%3Aexpect%7D%5Cend%7Baligned%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\begin{aligned} \mathbb{E}[X_{\alpha}] = 2^n \cdot \mathbb{E}[w_j(x)]^m = 2^n \left(2^{-k}\sum_{t = 1}^k \binom{k}{t} \eta^t \right)^m = 2^n \left(\left(\frac{1+\eta}{2}\right)^k-2^{-k}\right)^m.\label{eq:expect}\end{aligned}"/></p>
<p>And calculating again the second moment,</p>
<p><img alt="\mathbb{E}[X_{\alpha}^2] = \sum_{x,y} \prod_{j \in [m]} \mathbb{E}[w_j(x)\cdot w_j(y)]." class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BX_%7B%5Calpha%7D%5E2%5D+%3D+%5Csum_%7Bx%2Cy%7D+%5Cprod_%7Bj+%5Cin+%5Bm%5D%7D+%5Cmathbb%7BE%7D%5Bw_j%28x%29%5Ccdot+w_j%28y%29%5D.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[X_{\alpha}^2] = \sum_{x,y} \prod_{j \in [m]} \mathbb{E}[w_j(x)\cdot w_j(y)]."/></p>
<p>For a fixed clause <img alt="j" class="latex" src="https://s0.wp.com/latex.php?latex=j&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="j"/>, we can partition the variables in its scope into 4 sets, according to whether <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> agree on the variable, and whether the variable does or does not satisfy the literals of the clause. Suppose that <img alt="w_j" class="latex" src="https://s0.wp.com/latex.php?latex=w_j&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j"/> has <img alt="a" class="latex" src="https://s0.wp.com/latex.php?latex=a&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="a"/> variables on which <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> agree, and that of these <img alt="t" class="latex" src="https://s0.wp.com/latex.php?latex=t&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="t"/> are satisfying for <img alt="w_j" class="latex" src="https://s0.wp.com/latex.php?latex=w_j&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j"/> and <img alt="a - t" class="latex" src="https://s0.wp.com/latex.php?latex=a+-+t&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="a - t"/> are not.</p>
<p><img alt="agreement-numbers" class="alignnone wp-image-6206" src="https://windowsontheory.files.wordpress.com/2018/09/agreement-numbers.png?w=300" width="300"/></p>
<p>Then, <img alt="w_j" class="latex" src="https://s0.wp.com/latex.php?latex=w_j&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j"/> has <img alt="k-a" class="latex" src="https://s0.wp.com/latex.php?latex=k-a&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k-a"/> variables on which <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> disagree, and any variable which does not satisfy <img alt="w_j" class="latex" src="https://s0.wp.com/latex.php?latex=w_j&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j"/> for <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> must satisfy it for <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/>. For a <img alt="w_j(x) w_j(y)" class="latex" src="https://s0.wp.com/latex.php?latex=w_j%28x%29+w_j%28y%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j(x) w_j(y)"/> to be nonzero, either there must be at least one literal in the variables on which <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> agree which agrees with <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/>, or otherwise there must be at least one literal in the variables on which <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> disagree which agrees with each string. Therefore, if <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> agree on a <img alt="\delta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta"/>-fraction of variables,</p>
<p><img alt="\begin{aligned} \mathbb{E}[w_j(x) \cdot w_j(y)] &amp;= \sum_{a = 1}^k \sum_{t=1}^a \eta^{2t + k - a} \cdot \Pr[w_j \text{ has } a \text{ variables in } x \cap y,\ t \in x \cap y \text{ satisfy }w, \ w_j(x),w_j(y) \textgreater 0]\\ &amp;= \left(\sum_{a = 0}^k\sum_{t=0}^a \eta^{k - a + 2t} \cdot \binom{k}{a}\delta^{a}\left(1 - \delta\right)^{k-a} 2^{-a} \binom{a}{t}\right) - \left(\sum_{a=0}^k \eta^{k-a} \binom{k}{a} \delta^a(1-\delta)^{k-a} 2^{-k+1}\right) + \delta^k2^{-k},\end{aligned}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D+%5Cmathbb%7BE%7D%5Bw_j%28x%29+%5Ccdot+w_j%28y%29%5D+%26%3D+%5Csum_%7Ba+%3D+1%7D%5Ek+%5Csum_%7Bt%3D1%7D%5Ea+%5Ceta%5E%7B2t+%2B+k+-+a%7D+%5Ccdot+%5CPr%5Bw_j+%5Ctext%7B+has+%7D+a+%5Ctext%7B+variables+in+%7D+x+%5Ccap+y%2C%5C+t+%5Cin+x+%5Ccap+y+%5Ctext%7B+satisfy+%7Dw%2C+%5C+w_j%28x%29%2Cw_j%28y%29+%5Ctextgreater+0%5D%5C%5C+%26%3D+%5Cleft%28%5Csum_%7Ba+%3D+0%7D%5Ek%5Csum_%7Bt%3D0%7D%5Ea+%5Ceta%5E%7Bk+-+a+%2B+2t%7D+%5Ccdot+%5Cbinom%7Bk%7D%7Ba%7D%5Cdelta%5E%7Ba%7D%5Cleft%281+-+%5Cdelta%5Cright%29%5E%7Bk-a%7D+2%5E%7B-a%7D+%5Cbinom%7Ba%7D%7Bt%7D%5Cright%29+-+%5Cleft%28%5Csum_%7Ba%3D0%7D%5Ek+%5Ceta%5E%7Bk-a%7D+%5Cbinom%7Bk%7D%7Ba%7D+%5Cdelta%5Ea%281-%5Cdelta%29%5E%7Bk-a%7D+2%5E%7B-k%2B1%7D%5Cright%29+%2B+%5Cdelta%5Ek2%5E%7B-k%7D%2C%5Cend%7Baligned%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\begin{aligned} \mathbb{E}[w_j(x) \cdot w_j(y)] &amp;= \sum_{a = 1}^k \sum_{t=1}^a \eta^{2t + k - a} \cdot \Pr[w_j \text{ has } a \text{ variables in } x \cap y,\ t \in x \cap y \text{ satisfy }w, \ w_j(x),w_j(y) \textgreater 0]\\ &amp;= \left(\sum_{a = 0}^k\sum_{t=0}^a \eta^{k - a + 2t} \cdot \binom{k}{a}\delta^{a}\left(1 - \delta\right)^{k-a} 2^{-a} \binom{a}{t}\right) - \left(\sum_{a=0}^k \eta^{k-a} \binom{k}{a} \delta^a(1-\delta)^{k-a} 2^{-k+1}\right) + \delta^k2^{-k},\end{aligned}"/></p>
<p>where the first sum ignores the cases when <img alt="w_j(x) = 0" class="latex" src="https://s0.wp.com/latex.php?latex=w_j%28x%29+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j(x) = 0"/> or <img alt="w_j(y) = 0" class="latex" src="https://s0.wp.com/latex.php?latex=w_j%28y%29+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="w_j(y) = 0"/>, the second sum subtracts for the cases when <img alt="t=0" class="latex" src="https://s0.wp.com/latex.php?latex=t%3D0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="t=0"/> the contribution of the terms where all the literals agree with either <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> or <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/>, and the final term accounts for the fact that the term <img alt="a = k" class="latex" src="https://s0.wp.com/latex.php?latex=a+%3D+k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="a = k"/> is subtracted<br/>
twice. Simplifying,</p>
<p><img alt="\mathbb{E}[w_j(x) \cdot w_j(y)] = \left(\frac{(1+\eta^2)}{2}\delta + \eta(1-\delta)\right)^k - 2^{1-k} \left(\eta(1-\delta) + \delta\right)^k + \left(\frac{\delta}{2}\right)^k." class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5Bw_j%28x%29+%5Ccdot+w_j%28y%29%5D+%3D+%5Cleft%28%5Cfrac%7B%281%2B%5Ceta%5E2%29%7D%7B2%7D%5Cdelta+%2B+%5Ceta%281-%5Cdelta%29%5Cright%29%5Ek+-+2%5E%7B1-k%7D+%5Cleft%28%5Ceta%281-%5Cdelta%29+%2B+%5Cdelta%5Cright%29%5Ek+%2B+%5Cleft%28%5Cfrac%7B%5Cdelta%7D%7B2%7D%5Cright%29%5Ek.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[w_j(x) \cdot w_j(y)] = \left(\frac{(1+\eta^2)}{2}\delta + \eta(1-\delta)\right)^k - 2^{1-k} \left(\eta(1-\delta) + \delta\right)^k + \left(\frac{\delta}{2}\right)^k."/></p>
<p>Define<br/>
<img alt="q_{\eta}(\delta) =\left(\frac{(1+\eta^2)}{2}\delta + \eta(1-\delta)\right)^k - 2^{1-k} \left(\eta(1-\delta) + \delta\right)^k + \left(\frac{\delta}{2}\right)^k" class="latex" src="https://s0.wp.com/latex.php?latex=q_%7B%5Ceta%7D%28%5Cdelta%29+%3D%5Cleft%28%5Cfrac%7B%281%2B%5Ceta%5E2%29%7D%7B2%7D%5Cdelta+%2B+%5Ceta%281-%5Cdelta%29%5Cright%29%5Ek+-+2%5E%7B1-k%7D+%5Cleft%28%5Ceta%281-%5Cdelta%29+%2B+%5Cdelta%5Cright%29%5Ek+%2B+%5Cleft%28%5Cfrac%7B%5Cdelta%7D%7B2%7D%5Cright%29%5Ek&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="q_{\eta}(\delta) =\left(\frac{(1+\eta^2)}{2}\delta + \eta(1-\delta)\right)^k - 2^{1-k} \left(\eta(1-\delta) + \delta\right)^k + \left(\frac{\delta}{2}\right)^k"/>.<br/>
So we have (using Laplace’s method again)</p>
<p><img alt="\mathbb{E}[X^2] = 2^n \sum_{\ell = 0}^n \binom{n}{\ell} q_\eta\left(\frac{\ell}{n}\right)^{\alpha n} \approx O(1) \cdot \exp(\max_{\delta \in [0,1]} \psi_\eta (\delta) \cdot n)," class="latex" src="https://s0.wp.com/latex.php?latex=%5Cmathbb%7BE%7D%5BX%5E2%5D+%3D+2%5En+%5Csum_%7B%5Cell+%3D+0%7D%5En+%5Cbinom%7Bn%7D%7B%5Cell%7D+q_%5Ceta%5Cleft%28%5Cfrac%7B%5Cell%7D%7Bn%7D%5Cright%29%5E%7B%5Calpha+n%7D+%5Capprox+O%281%29+%5Ccdot+%5Cexp%28%5Cmax_%7B%5Cdelta+%5Cin+%5B0%2C1%5D%7D+%5Cpsi_%5Ceta+%28%5Cdelta%29+%5Ccdot+n%29%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\mathbb{E}[X^2] = 2^n \sum_{\ell = 0}^n \binom{n}{\ell} q_\eta\left(\frac{\ell}{n}\right)^{\alpha n} \approx O(1) \cdot \exp(\max_{\delta \in [0,1]} \psi_\eta (\delta) \cdot n),"/></p>
<p>For<br/>
<img alt="\psi_\eta(\delta) = H(\delta) + \ln 2 + \alpha \ln q_{\eta}(\delta)." class="latex" src="https://s0.wp.com/latex.php?latex=%5Cpsi_%5Ceta%28%5Cdelta%29+%3D+H%28%5Cdelta%29+%2B+%5Cln+2+%2B+%5Calpha+%5Cln+q_%7B%5Ceta%7D%28%5Cdelta%29.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\psi_\eta(\delta) = H(\delta) + \ln 2 + \alpha \ln q_{\eta}(\delta)."/></p>
<p>When <img alt="\delta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta = \frac{1}{2}"/>,</p>
<p><img alt="q_{\eta}\left(\frac{1}{2}\right) = \left(\left(\frac{1+\eta}{2}\right)^k - \frac{1}{2^k}\right)^2," class="latex" src="https://s0.wp.com/latex.php?latex=q_%7B%5Ceta%7D%5Cleft%28%5Cfrac%7B1%7D%7B2%7D%5Cright%29+%3D+%5Cleft%28%5Cleft%28%5Cfrac%7B1%2B%5Ceta%7D%7B2%7D%5Cright%29%5Ek+-+%5Cfrac%7B1%7D%7B2%5Ek%7D%5Cright%29%5E2%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="q_{\eta}\left(\frac{1}{2}\right) = \left(\left(\frac{1+\eta}{2}\right)^k - \frac{1}{2^k}\right)^2,"/></p>
<p>which is equal to the log of the square of the expectation, so again for the second moment method to succeed, <img alt="\delta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta = \frac{1}{2}"/> must be the global maximum.</p>
<p>Guided by this consideration, we can set <img alt="\eta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Ceta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\eta"/> so that the derivative <img alt="q_{\eta}'(\frac{1}{2}) = 0" class="latex" src="https://s0.wp.com/latex.php?latex=q_%7B%5Ceta%7D%27%28%5Cfrac%7B1%7D%7B2%7D%29+%3D+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="q_{\eta}'(\frac{1}{2}) = 0"/>, so that <img alt="\psi_\eta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cpsi_%5Ceta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\psi_\eta"/> achieves a local maximum at <img alt="\delta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta = \frac{1}{2}"/>. The choice for this (after doing some calculus) turns out to be the positive, real solution to the equation <img alt="(1+\eta)^{k-1}(1-\eta) = 1" class="latex" src="https://s0.wp.com/latex.php?latex=%281%2B%5Ceta%29%5E%7Bk-1%7D%281-%5Ceta%29+%3D+1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="(1+\eta)^{k-1}(1-\eta) = 1"/>. With this choice, one can show that the global maximum is indeed achieved at <img alt="\delta = \frac{1}{2}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%3D+%5Cfrac%7B1%7D%7B2%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta = \frac{1}{2}"/> as long as <img alt="\alpha \textless 2^k \ln 2 - O(k)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Ctextless+2%5Ek+%5Cln+2+-+O%28k%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha \textless 2^k \ln 2 - O(k)"/>. Below, we plot <img alt="\psi_{\eta}" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cpsi_%7B%5Ceta%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\psi_{\eta}"/> with this optimal choice of <img alt="\eta" class="latex" src="https://s0.wp.com/latex.php?latex=%5Ceta&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\eta"/> for several values of <img alt="\alpha" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha"/> at <img alt="k = 5" class="latex" src="https://s0.wp.com/latex.php?latex=k+%3D+5&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k = 5"/>:</p>
<p><img alt="fancy-second-moment" class="alignnone size-full wp-image-6211" src="https://windowsontheory.files.wordpress.com/2018/09/fancy-second-moment.png?w=600"/></p>
<p>So we have bounded <img alt="\alpha_c \ge 2^k \ln 2 - O(k)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c+%5Cge+2%5Ek+%5Cln+2+-+O%28k%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c \ge 2^k \ln 2 - O(k)"/>.</p>
<h3>Another phase transition</h3>
<p>What is the correct answer for <img alt="\alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c"/>? We now have it in a window of size <img alt="O(k)" class="latex" src="https://s0.wp.com/latex.php?latex=O%28k%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="O(k)"/>. Experimental data and heuristic predictions indicate that it is closer to <img alt="2^k \ln 2 - O(1)" class="latex" src="https://s0.wp.com/latex.php?latex=2%5Ek+%5Cln+2+-+O%281%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="2^k \ln 2 - O(1)"/> (and in fact for large <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>, Ding, Sly and Sun showed that <img alt="\alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha_c"/> is a specific constant in the interval <img alt="[2^k \ln 2 -2, 2^k \ln 2]" class="latex" src="https://s0.wp.com/latex.php?latex=%5B2%5Ek+%5Cln+2+-2%2C+2%5Ek+%5Cln+2%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="[2^k \ln 2 -2, 2^k \ln 2]"/>). So why can’t we push the second moment method further?</p>
<p>It turns out that there is a good reason for this, having to do with another phase transition. In fact, we know that <img alt="k" class="latex" src="https://s0.wp.com/latex.php?latex=k&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k"/>-SAT has not only satisfiable and unsatisfiable phases, but also <em>clustering</em> and <em>condensation</em> phases:</p>
<p><img alt="ksat-phases" class="alignnone size-full wp-image-6212" src="https://windowsontheory.files.wordpress.com/2018/09/ksat-phases.png?w=600"/></p>
<p>In the clustering phase, there are exponentially many clusters of solutions, each containing exponentially many solutions, and each at hamming distance <img alt="\Omega(n)" class="latex" src="https://s0.wp.com/latex.php?latex=%5COmega%28n%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Omega(n)"/> from each other. In the condensation phase, there are even fewer clusters, but solutions still exist. We can see evidence of this already in the way that the second moment method failed us. When <img alt="\alpha \textgreater 2^k \ln 2 - O(k)" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%5Ctextgreater+2%5Ek+%5Cln+2+-+O%28k%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha \textgreater 2^k \ln 2 - O(k)"/>, we see that the global maximum of the exponent is actually attained close to <img alt="\delta = 1" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%3D+1&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta = 1"/>. This is because solutions with large overlap come to dominate the set of satisfying assignments.</p>
<p>One can also establish the existence of clusters using the method of moments. The trick is to compute the probability that two solutions, <img alt="x" class="latex" src="https://s0.wp.com/latex.php?latex=x&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x"/> and <img alt="y" class="latex" src="https://s0.wp.com/latex.php?latex=y&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="y"/> with overlap <img alt="\delta n" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta n"/>, are both satisfying for <img alt="\phi" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cphi&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\phi"/>. In fact, we have already done this. From above,</p>
<p><img alt="\Pr\left[\phi(x) \wedge \phi(y) ~\mid~ \frac{1}{2}\|x - y\|_1 = (1-\delta)n\right] = \left(1 - 2\cdot \frac{1}{2^k} + 2^{-k}\delta^k\right)^{\alpha n}." class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5Cleft%5B%5Cphi%28x%29+%5Cwedge+%5Cphi%28y%29+%7E%5Cmid%7E+%5Cfrac%7B1%7D%7B2%7D%5C%7Cx+-+y%5C%7C_1+%3D+%281-%5Cdelta%29n%5Cright%5D+%3D+%5Cleft%281+-+2%5Ccdot+%5Cfrac%7B1%7D%7B2%5Ek%7D+%2B+2%5E%7B-k%7D%5Cdelta%5Ek%5Cright%29%5E%7B%5Calpha+n%7D.&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr\left[\phi(x) \wedge \phi(y) ~\mid~ \frac{1}{2}\|x - y\|_1 = (1-\delta)n\right] = \left(1 - 2\cdot \frac{1}{2^k} + 2^{-k}\delta^k\right)^{\alpha n}."/></p>
<p>Now, by a union bound, an upper bound on the probability that there exists a pair of solutions <img alt="x,y" class="latex" src="https://s0.wp.com/latex.php?latex=x%2Cy&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="x,y"/> with overlap <img alt="\delta n" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta n"/> for any <img alt="\delta \in [\delta_1,\delta_2]" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%5Cin+%5B%5Cdelta_1%2C%5Cdelta_2%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta \in [\delta_1,\delta_2]"/> is at most</p>
<p><img alt="\Pr[\exists x,y \ s.t. \ \phi(x) \wedge \phi(y), \ \frac{1}{2}\|x-y\|_1 = (1-\delta)n \text{ for } \delta \in [\delta_1,\delta_2]] \le \sum_{\ell = \delta_1 n}^{\delta_2 n} \binom{n}{\ell} \left(1 - 2^{1-k} + \left(\frac{\ell}{2n}\right)^k\right)^{\alpha n}" class="latex" src="https://s0.wp.com/latex.php?latex=%5CPr%5B%5Cexists+x%2Cy+%5C+s.t.+%5C+%5Cphi%28x%29+%5Cwedge+%5Cphi%28y%29%2C+%5C+%5Cfrac%7B1%7D%7B2%7D%5C%7Cx-y%5C%7C_1+%3D+%281-%5Cdelta%29n+%5Ctext%7B+for+%7D+%5Cdelta+%5Cin+%5B%5Cdelta_1%2C%5Cdelta_2%5D%5D+%5Cle+%5Csum_%7B%5Cell+%3D+%5Cdelta_1+n%7D%5E%7B%5Cdelta_2+n%7D+%5Cbinom%7Bn%7D%7B%5Cell%7D+%5Cleft%281+-+2%5E%7B1-k%7D+%2B+%5Cleft%28%5Cfrac%7B%5Cell%7D%7B2n%7D%5Cright%29%5Ek%5Cright%29%5E%7B%5Calpha+n%7D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\Pr[\exists x,y \ s.t. \ \phi(x) \wedge \phi(y), \ \frac{1}{2}\|x-y\|_1 = (1-\delta)n \text{ for } \delta \in [\delta_1,\delta_2]] \le \sum_{\ell = \delta_1 n}^{\delta_2 n} \binom{n}{\ell} \left(1 - 2^{1-k} + \left(\frac{\ell}{2n}\right)^k\right)^{\alpha n}"/><br/>
<img alt="\le \int_{\delta_1}^{\delta_2} \exp\left( \left(H(\delta) + \ln 2 + \alpha \ln \left(1-2^{1-k} + 2^{-k}\delta^k\right)\right)n\right) d\delta," class="latex" src="https://s0.wp.com/latex.php?latex=%5Cle+%5Cint_%7B%5Cdelta_1%7D%5E%7B%5Cdelta_2%7D+%5Cexp%5Cleft%28+%5Cleft%28H%28%5Cdelta%29+%2B+%5Cln+2+%2B+%5Calpha+%5Cln+%5Cleft%281-2%5E%7B1-k%7D+%2B+2%5E%7B-k%7D%5Cdelta%5Ek%5Cright%29%5Cright%29n%5Cright%29+d%5Cdelta%2C&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\le \int_{\delta_1}^{\delta_2} \exp\left( \left(H(\delta) + \ln 2 + \alpha \ln \left(1-2^{1-k} + 2^{-k}\delta^k\right)\right)n\right) d\delta,"/></p>
<p>and if the function <img alt="\beta(\delta) := H(\delta) + \ln 2 + \alpha\ln (1 + 2^{-k}\delta^k - 2^{1-k})" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta%28%5Cdelta%29+%3A%3D+H%28%5Cdelta%29+%2B+%5Cln+2+%2B+%5Calpha%5Cln+%281+%2B+2%5E%7B-k%7D%5Cdelta%5Ek+-+2%5E%7B1-k%7D%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta(\delta) := H(\delta) + \ln 2 + \alpha\ln (1 + 2^{-k}\delta^k - 2^{1-k})"/> is such that <img alt="\beta(\delta) \textless 0" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cbeta%28%5Cdelta%29+%5Ctextless+0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\beta(\delta) \textless 0"/> for all <img alt="\delta \in [\delta_1,\delta_2]" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cdelta+%5Cin+%5B%5Cdelta_1%2C%5Cdelta_2%5D&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\delta \in [\delta_1,\delta_2]"/>, then we conclude that the probability that there is a pair of satisfying assignments at distance between <img alt="(1-\delta_2)n" class="latex" src="https://s0.wp.com/latex.php?latex=%281-%5Cdelta_2%29n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="(1-\delta_2)n"/> and <img alt="(1-\delta_1)n" class="latex" src="https://s0.wp.com/latex.php?latex=%281-%5Cdelta_1%29n&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="(1-\delta_1)n"/> is <img alt="o(1)" class="latex" src="https://s0.wp.com/latex.php?latex=o%281%29&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="o(1)"/>.</p>
<p>Achlioptas and Ricci-Tersenghi showed that for <img alt="k \ge 4" class="latex" src="https://s0.wp.com/latex.php?latex=k+%5Cge+4&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k \ge 4"/>, <img alt="\alpha = (1-\eta)2^k" class="latex" src="https://s0.wp.com/latex.php?latex=%5Calpha+%3D+%281-%5Ceta%292%5Ek&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\alpha = (1-\eta)2^k"/>, and <img alt="\epsilon" class="latex" src="https://s0.wp.com/latex.php?latex=%5Cepsilon&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="\epsilon"/> a fixed constant, the above function is less than <img alt="0" class="latex" src="https://s0.wp.com/latex.php?latex=0&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="0"/>. Rather than doing the tedious calculus, we can verify by plotting for <img alt="k = 8, \alpha = 169" class="latex" src="https://s0.wp.com/latex.php?latex=k+%3D+8%2C+%5Calpha+%3D+169&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="k = 8, \alpha = 169"/> (with <img alt="169 \textless \alpha_c" class="latex" src="https://s0.wp.com/latex.php?latex=169+%5Ctextless+%5Calpha_c&amp;bg=ffffff&amp;fg=333333&amp;s=0" title="169 \textless \alpha_c"/>):</p>
<p> </p>
<p><img alt="clusters" class="alignnone size-full wp-image-6207" src="https://windowsontheory.files.wordpress.com/2018/09/clusters.png?w=600"/></p>
<p>They also use the second moment method to show the clusters are non-empty, that there are exponentially many of them, each containing exponentially many solutions. This gives a proof of the existence of a clustering regime.</p>
<h3>Solution geometry and algorithms</h3>
<p>This study of the space of solutions is referred to as <em>solution geometry</em>, and understanding solution geometry turns out to be essential in proving better bounds on the critical density.</p>
<p>Solution geometry is also intimately related to the success of local search algorithms such as belief propagation, and to heuristics for predicting phase transitions such as replica symmetry breaking.</p>
<p>These topics and more to follow, in the coming weeks.</p>
<h2>Resources</h2>
<p>In preparing this blog post/lecture I leaned heavily on Chapters 2 and 10 of Marc Mézard and Andrea Montanari’s <a href="https://web.stanford.edu/~montanar/RESEARCH/book.html">“Information, Physics, and Computation”</a>, on Chapters 12,13,&amp;14 of Cris Moore and Stephan Mertens’ <a href="http://nature-of-computation.org/">“The nature of Computation,”</a> and on Dimitris Achlioptas and Federico Ricci-Tersenghi’s manuscript <a href="https://arxiv.org/abs/cs/0611052">“On the Solution-Space Geometry of Random CSPs”</a>. I also consulted Wikipedia for some physics basics.</p></div></content><updated planet:format="September 15, 2018 09:10 PM">2018-09-15T21:10:17Z</updated><published planet:format="September 15, 2018 09:10 PM">2018-09-15T21:10:17Z</published><category term="physics"/><author><name>tselilschramm</name></author><source><id>https://windowsontheory.org</id><logo>https://s0.wp.com/i/buttonw-com.png</logo><link href="https://windowsontheory.org/feed/" rel="self" type="application/atom+xml"/><link href="https://windowsontheory.org" rel="alternate" type="text/html"/><link href="https://windowsontheory.org/osd.xml" rel="search" type="application/opensearchdescription+xml"/><link href="https://windowsontheory.org/?pushpress=hub" rel="hub" type="text/html"/><subtitle>A Research Blog</subtitle><title>Windows On Theory</title><updated planet:format="December 16, 2018 04:43 PM">2018-12-16T16:43:31Z</updated><planet:module>toc</planet:module><planet:format>atom10</planet:format><planet:http_last_modified>Fri, 14 Dec 2018 13:40:57 GMT</planet:http_last_modified><planet:bozo>false</planet:bozo><planet:items_per_page>40</planet:items_per_page><planet:css-id>windows-on-theory</planet:css-id><planet:face>wot.png</planet:face><planet:name>Windows on Theory</planet:name><planet:http_location>https://windowsontheory.org/feed/</planet:http_location><planet:http_status>301</planet:http_status></source></entry>
