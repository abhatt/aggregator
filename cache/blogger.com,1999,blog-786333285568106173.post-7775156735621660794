<?xml version="1.0" encoding="utf-8"?><entry xmlns="http://www.w3.org/2005/Atom" xmlns:planet="http://planet.intertwingly.net/"><id>tag:blogger.com,1999:blog-786333285568106173.post-7775156735621660794</id><link href="http://infoweekly.blogspot.com/feeds/7775156735621660794/comments/default" rel="replies" type="application/atom+xml"/><link href="http://www.blogger.com/comment.g?blogID=786333285568106173&amp;postID=7775156735621660794" rel="replies" type="text/html"/><link href="http://www.blogger.com/feeds/786333285568106173/posts/default/7775156735621660794" rel="edit" type="application/atom+xml"/><link href="http://www.blogger.com/feeds/786333285568106173/posts/default/7775156735621660794" rel="self" type="application/atom+xml"/><link href="http://infoweekly.blogspot.com/2011/09/follow-up-sampling-discrete.html" rel="alternate" type="text/html"/><title>Follow-up: Sampling a discrete distribution</title><content type="xhtml"><div xmlns="http://www.w3.org/1999/xhtml"><span class="Apple-style-span" style="font-family: Georgia, serif;">This is a follow-up to my last </span><a href="http://infoweekly.blogspot.com/2011/09/sampling-discrete-distribution.html" style="font-family: Georgia, serif; font-size: 16px;">post</a><span class="Apple-style-span" style="font-family: Georgia, serif;">, on a puzzle about &quot;Sampling a discrete distribution&quot; (see my comment there for the solution I originally thought of).</span><br/><div style="font-family: Georgia, serif; font-size: 16px;"><br/></div><div style="font-family: Georgia, serif; font-size: 16px;">As an anonymous commenter (Rex?) points out, a nice elementary solution that has been known for a long time. <span class="Apple-style-span" style="font-size: small;">I admit to not knowing this solution ahead of time, and use the fact that it's not really my field as an excuse. Here I want to summarize this solution for educational purposes.</span></div><div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">Imagine each sample in the distribution is a vase containing liquid proportional to the probability of the outcome.</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">We classify these vases into 3 types:</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><i><u>LO</u> —  </i>probability less than 1/n</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><i><u>GOOD</u></i> –  probability precisely 1/n</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><i><u>HI</u></i> –  probability greater then 1/n</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">In the ideal case when every vase is GOOD, we are done (uniform sampling). If not, we  move towards this ideal case by inductively applying the following subroutine:</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">** Pick a LO vase (say, with x amount of liquid) and a HI vase (with y amount of liquid).</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">Grab a new vase and fill it up to the 1/n mark: pour all the liquid from the LO vase, and (1/n)-x liquid from the HI vase (remember that a HI vase has liquid y&gt;1/n, so this is certainly possible). Note that the HI vase may now become LO, GOOD, or stay HI.</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">/end of **</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">Observe that the process terminates in n steps, since at each step we increment the number of GOOD vases.  If we maintain 3 linked lists with samples of each type, each step can be done in  O(1) time, so O(n) time total.</span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">At the end all vases are GOOD so we use uniform sampling. If we get a random x in [0,1], we use ⌊x·n⌋ to indicate that vase and </span>x·n mod 1 to pick a molecule of  water inside that vase. If we trace back the original vase from where this molecule came, we have sampled according to the initial distribution.</div><div><span class="Apple-style-span" style="font-family: Georgia, serif;"><br/></span></div><div><span class="Apple-style-span" style="font-family: Georgia, serif;">Now we describe how to &quot;undo&quot; the water pouring at query time, i.e. tracing the origin of each water molecule. Observe that operation (**) is never applied to a GOOD vase. So when a vase becomes GOOD, it has reached final form. But the water in a GOOD vase can only come from two distinct vases. So we can essentially draw a water-mark on the vase, to separate the LO water from HI water and store pointers to the original vases whose water got poured into the GOOD vase. Then the sampling algorithm only need one comparison, i.e. it compares </span>x·n mod 1 to the mark on the vase <span class="Apple-style-span" style="font-family: Georgia, serif;">⌊x·n⌋, and follows a pointer from this vase to the input vases from which water was poured. Note that only one pointer is followed, since a GOOD vase is never touched again by operation (**).</span> Constant time!</div></div></div><div class="commentbar"><p/><span class="commentbutton" href="http://infoweekly.blogspot.com/feeds/7775156735621660794/comments/default"/><a href="http://infoweekly.blogspot.com/feeds/7775156735621660794/comments/default"><img class="commenticon" src="/images/feed-icon.png"/> Subscribe to comments</a><![CDATA[  | ]]><a href="http://www.blogger.com/comment.g?blogID=786333285568106173&amp;postID=7775156735621660794"><img class="commenticon" src="/images/post-icon.png"/> Post a comment</a></div></content><updated planet:format="September 19, 2011 08:03 PM">2011-09-19T20:03:00Z</updated><published planet:format="September 19, 2011 08:03 PM">2011-09-19T20:03:00Z</published><author><name>Mihai</name><email>noreply@blogger.com</email><uri>http://www.blogger.com/profile/11599372864611039927</uri></author><source><id>tag:blogger.com,1999:blog-786333285568106173</id><author><name>Mihai</name><email>noreply@blogger.com</email><uri>http://www.blogger.com/profile/11599372864611039927</uri></author><link href="http://infoweekly.blogspot.com/" rel="alternate" type="text/html"/><link href="http://www.blogger.com/feeds/786333285568106173/posts/default?start-index=26&amp;max-results=25&amp;redirect=false" rel="next" type="application/atom+xml"/><link href="http://feeds.feedburner.com/WebdiariosDeMotocicleta" rel="self" type="application/atom+xml"/><link href="http://pubsubhubbub.appspot.com/" rel="hub" type="text/html"/><subtitle>Informatics Weekly, written by Mihai Pătraşcu.</subtitle><title>WebDiarios de Motocicleta</title><updated planet:format="September 17, 2018 03:40 AM">2018-09-17T03:40:52Z</updated><planet:module>toc</planet:module><planet:format>atom10</planet:format><planet:http_etag>p4aBUs7EfDbSpgYtTTaw3ObCwMk</planet:http_etag><planet:http_last_modified>Sun, 16 Dec 2018 15:48:09 GMT</planet:http_last_modified><planet:bozo>false</planet:bozo><planet:items_per_page>40</planet:items_per_page><planet:css-id>webdiarios-de-motocicleta</planet:css-id><planet:face>mihai.jpg</planet:face><planet:name>WebDiarios de Motocicleta</planet:name><planet:http_status>200</planet:http_status></source></entry>
